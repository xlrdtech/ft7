<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FultonTech7 - Mobile Technician | Fulton County, GA</title>
    <meta name="description" content="Professional mobile automotive technician serving Fulton County, GA. Transparent pricing, same-week appointments. Basic $250, Comprehensive $350, Premium $450.">

    <!-- Schema.org LocalBusiness structured data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "LocalBusiness",
      "name": "FultonTech7",
      "description": "Professional mobile automotive technician serving Fulton County, GA",
      "telephone": "+17739999783", /* Updated Phone */
      "email": "fultontech7@gmail.com", /* Added Email */
      "areaServed": ["South Fulton", "Union City", "Fairburn", "Palmetto"],
      "serviceType": "Mobile Automotive Technician",
      "priceRange": "$250-$450",
      "address": {
        "@type": "PostalAddress",
        "addressLocality": "Fulton County",
        "addressRegion": "GA",
        "addressCountry": "US"
      }
    }
    </script>

    <style>
        /* Reset and base styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
            font-size: 16px;
        }

        body {
            font-family: 'Inter', 'Roboto', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            line-height: 1.6;
            color: #0F1720;
            background-color: #F5F5F5;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Custom properties */
        :root {
            --primary-color: #7A8B99;
            --accent-color: #1A2332;
            --background-light: #F5F5F5;
            --background-white: #FFFFFF;
            --text-primary: #0F1720;
            --text-muted: #67727e;
            --border-color: rgba(122, 139, 153, 0.2);
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --radius: 8px;
            --radius-lg: 12px;
            --container-width: 1200px;
            --container-medium-width: 800px; /* For forms/tools */
            --section-padding: 4rem 0;
            --accent-color-rgb: 26, 35, 50;
            --primary-color-rgb: 122, 139, 153;
            --header-height: 80px; /* Define header height */
        }

        /* Typography */
        h1, h2, h3, h4, h5, h6 {
            font-weight: 600;
            line-height: 1.2;
            margin-bottom: 0.5em;
        }

        h1 { font-size: 2.5rem; }
        h2 { font-size: 2rem; }
        h3 { font-size: 1.5rem; }
        h4 { font-size: 1.25rem; }
        h5 { font-size: 1.125rem; }
        h6 { font-size: 1rem; }

        p {
            margin-bottom: 1em;
        }

        a {
            color: var(--primary-color);
            text-decoration: none;
            transition: color 0.3s ease;
        }
        a:hover {
             color: var(--accent-color);
        }

        /* Container */
        .container {
            max-width: var(--container-width);
            margin: 0 auto;
            padding: 0 1rem;
        }
        .container--medium {
             max-width: var(--container-medium-width);
        }


        /* Header */
        .header {
            background: var(--background-white);
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 1px solid var(--border-color);
        }

        .header__content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem 0;
            min-height: var(--header-height);
        }

        .header__logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            cursor: pointer; /* Interactive logo */
        }

        .logo {
            width: 48px;
            height: 48px;
            object-fit: contain;
        }

        .header__title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 0; /* Override heading margin */
        }

        .header__nav { /* Desktop Only Nav placeholder */
            display: none; /* Hidden by default, shown via media query */
            align-items: center;
            gap: 2rem;
        }
         @media (min-width: 769px) { /* Adjust breakpoint if needed */
             .header__nav {
                 display: flex;
             }
         }


        .nav-link {
            text-decoration: none;
            color: var(--text-primary);
            font-weight: 500;
            transition: color 0.3s ease;
            cursor: pointer;
        }

        .nav-link:hover {
            color: var(--primary-color);
        }

        /* --- Mobile Menu Toggle --- */
        .mobile-menu-toggle {
            display: none; /* Hidden by default, shown on mobile */
            cursor: pointer;
            padding: 0.5rem;
            border: none;
            background: none;
        }
        .hamburger-icon {
            display: block;
            width: 24px;
            height: 2px;
            background-color: var(--text-primary);
            position: relative;
            transition: background-color 0.3s ease;
        }
        .hamburger-icon::before,
        .hamburger-icon::after {
            content: '';
            display: block;
            width: 24px;
            height: 2px;
            background-color: var(--text-primary);
            position: absolute;
            left: 0;
            transition: transform 0.3s ease;
        }
        .hamburger-icon::before { top: -7px; }
        .hamburger-icon::after { top: 7px; }

        /* Hamburger animation */
        .mobile-menu-toggle.open .hamburger-icon { background-color: transparent; }
        .mobile-menu-toggle.open .hamburger-icon::before { transform: translateY(7px) rotate(45deg); }
        .mobile-menu-toggle.open .hamburger-icon::after { transform: translateY(-7px) rotate(-45deg); }


        /* --- Tab Navigation (Desktop Tabs & Mobile Menu Content) --- */
        .tab-nav {
            background-color: var(--background-white);
            border-bottom: 1px solid var(--border-color);
            padding: 0.5rem 0;
             /* Default: Desktop Tabs */
             display: block;
        }
        .tab-nav-container {
             max-width: var(--container-width);
             margin: 0 auto;
             padding: 0 1rem;
             display: flex;
             gap: 0.5rem;
             justify-content: center; /* Center tabs */
             flex-wrap: wrap; /* Allow wrapping on small screens */
             text-align: center;
        }
        .tab-button {
            padding: 0.75rem 1.5rem;
            border: none;
            background: transparent;
            font-size: 1rem;
            font-weight: 500;
            color: var(--text-muted);
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            white-space: nowrap;
             display: inline-block; /* Default for Desktop */
             width: auto; /* Default for Desktop */
             text-align: center; /* Default for Desktop */
        }
        .tab-button:hover {
            color: var(--primary-color);
        }
        .tab-button.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
            font-weight: 600;
        }

        /* --- Mobile Menu Specific Styles --- */
        @media (max-width: 900px) { /* Increased breakpoint for mobile menu */
            .mobile-menu-toggle {
                display: block; /* Show hamburger on mobile */
            }
            .header__nav {
                 display: none; /* Hide desktop specific nav items if any */
            }
             .tab-nav { /* Repurpose as Mobile Menu Container */
                display: none; /* Hidden by default */
                position: absolute;
                top: var(--header-height); /* Position below header */
                left: 0;
                right: 0;
                background: var(--background-white);
                border-top: 1px solid var(--border-color);
                box-shadow: var(--shadow-lg);
                z-index: 999;
                padding: 1rem 0; /* Padding for the menu itself */
             }
             .tab-nav.mobile-menu-open {
                 display: block; /* Show when open */
                 animation: slideDown 0.3s ease-out;
             }
             .tab-nav-container {
                  flex-direction: column; /* Stack items vertically */
                  gap: 0; /* Remove gap for full width items */
                  padding: 0; /* Remove horizontal padding */
                  text-align: left; /* Align text left */
             }
             .tab-button {
                  display: block; /* Make buttons full width */
                  width: 100%;
                  padding: 1rem 1.5rem; /* Adjust padding for vertical layout */
                  border-bottom: 1px solid var(--border-color); /* Separator */
                  border-radius: 0; /* Remove radius */
                  text-align: left; /* Align text left */
             }
             .tab-button:last-child {
                 border-bottom: none; /* Remove border from last item */
             }
             .tab-button.active {
                 background-color: rgba(var(--primary-color-rgb), 0.1);
                 border-bottom-color: var(--border-color); /* Use standard border */
                 color: var(--primary-color);
                 font-weight: 600;
             }
        }
        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }


        /* --- Tab Content Area --- */
        .tab-content {
            padding-top: 2rem; /* Add space below tabs */
        }
        .tab-pane {
            display: none; /* Hide all panes by default */
        }
        .tab-pane.active {
            display: block; /* Show active pane */
             animation: fadeIn 0.5s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }


        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: var(--radius);
            font-weight: 600;
            text-decoration: none;
            cursor: pointer;
            transition: all 0.3s ease;
            min-height: 44px;
            font-size: 1rem;
            line-height: 1;
        }

        .btn--primary {
            background: var(--primary-color);
            color: var(--background-white);
        }

        .btn--primary:hover {
            background: var(--accent-color);
            transform: translateY(-2px);
        }

        .btn--secondary {
            background: transparent;
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
        }

        .btn--secondary:hover {
            background: var(--primary-color);
            color: var(--background-white);
        }
        /* Style for quick option buttons */
        .btn--quick-option {
            background: rgba(var(--primary-color-rgb), 0.08);
            color: var(--primary-color);
            border: 1px solid rgba(var(--primary-color-rgb), 0.2);
            padding: 0.5rem 1rem; /* Smaller padding */
            font-size: 0.875rem; /* Smaller font */
            min-height: auto; /* Allow natural height */
            font-weight: 500;
            border-radius: var(--radius-sm);
        }
        .btn--quick-option:hover {
            background: rgba(var(--primary-color-rgb), 0.15);
            border-color: rgba(var(--primary-color-rgb), 0.3);
            transform: translateY(-1px);
        }


        .btn--full {
            width: 100%;
        }

        /* Hero Section Styles */
        .hero {
            position: relative;
            text-align: center;
            color: var(--background-white);
            min-height: 60vh;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .hero img.hero-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: -1;
            filter: brightness(0.6);
        }

        .hero-content {
            background: rgba(var(--accent-color-rgb), 0.7);
            padding: 2rem;
            border-radius: var(--radius-lg);
            max-width: 600px;
            margin: 1rem;
            z-index: 1;
        }

        .hero-content h1 {
            font-size: 2.75rem;
            font-weight: 700;
            color: var(--background-white);
            margin-bottom: 0.75rem;
        }

        .hero-content p {
            font-size: 1.2rem;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 1.5rem;
        }

        .pricing {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            margin-bottom: 2rem;
            font-weight: 500;
            color: rgba(255, 255, 255, 0.85);
            flex-wrap: wrap;
        }

        .pricing span {
            background: rgba(var(--primary-color-rgb), 0.2);
            padding: 0.3rem 0.8rem;
            border-radius: var(--radius-sm);
        }

        .cta-button {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.85rem 2rem;
            border-radius: var(--radius);
            font-weight: 600;
            text-decoration: none;
            cursor: pointer;
            transition: all 0.3s ease;
            min-height: 48px;
            font-size: 1.1rem;
            line-height: 1;
            background: var(--primary-color);
            color: var(--background-white);
            border: none;
        }

        .cta-button:hover {
            background: var(--accent-color);
            transform: translateY(-2px);
        }

        @media (max-width: 768px) {
            .hero {
                min-height: 50vh;
            }
            .hero-content h1 {
                font-size: 2.25rem;
            }
             .hero-content p {
                 font-size: 1.1rem;
             }
            .pricing {
                gap: 1rem;
                font-size: 0.9rem;
            }
             .cta-button {
                 padding: 0.75rem 1.5rem;
                 font-size: 1rem;
             }
        }
         @media (max-width: 480px) {
            .hero-content h1 {
                font-size: 1.875rem;
            }
             .hero-content p {
                 font-size: 1rem;
             }
             .pricing span {
                 padding: 0.2rem 0.6rem;
             }
        }

        /* Services & Pricing */
        .services {
            padding: var(--section-padding);
            background: var(--background-white);
        }

        .section-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .section-title {
            color: var(--accent-color);
            margin-bottom: 1rem;
        }

        .section-subtitle {
            font-size: 1.125rem;
            color: var(--text-muted);
        }

        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 3rem;
        }

        .service-card {
            background: var(--background-white);
            padding: 2rem;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-lg);
            text-align: center;
            border: 2px solid transparent;
            transition: all 0.3s ease;
            cursor: pointer; /* Interactive card */
        }

        .service-card:hover {
            border-color: var(--primary-color);
            transform: translateY(-8px); /* Made hover effect more pronounced */
        }
        .service-card--hover {
            transform: translateY(-8px);
        }

        .service-price {
            font-size: 3rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 1rem;
        }

        .service-name {
            font-size: 1.5rem;
            color: var(--accent-color);
            margin-bottom: 1rem;
        }

        .service-description {
            color: var(--text-muted);
            margin-bottom: 1.5rem;
        }

        /* Service Areas */
        .service-areas {
            padding: var(--section-padding);
            background: var(--background-light);
            text-align: center;
        }

        .areas-grid {
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
            margin-top: 2rem;
        }

        .area-badge {
            background: var(--primary-color);
            color: var(--background-white);
            padding: 0.75rem 1.5rem;
            border-radius: var(--radius-lg);
            font-weight: 600;
            font-size: 1.125rem;
            cursor: pointer; /* Interactive badge */
            transition: all 0.3s ease;
        }

        .area-badge:hover {
            background: var(--accent-color);
            transform: translateY(-2px);
        }

        /* --- AI Common Options Styles --- */
         .common-options {
             margin-top: 1rem;
             display: flex;
             flex-wrap: wrap;
             gap: 0.75rem;
             padding-top: 1rem;
             border-top: 1px dashed var(--border-color);
             /* Added justify-content center */
             justify-content: center;
         }
         .common-options-label {
             font-size: 0.875rem;
             color: var(--text-muted);
             margin-bottom: 0.5rem;
             display: block;
             width: 100%; /* Take full width */
             /* Changed text-align to center */
             text-align: center;
         }


        /* --- AI FAQ Section Styles --- */
        .ai-faq {
            padding: var(--section-padding);
            background: var(--background-white); /* Match services section */
        }

        .ai-faq-container {
           /* max-width: 800px; /* Wider container for Q&A */
            margin: 0 auto;
            background: var(--background-light); /* Light background for contrast */
            padding: 2.5rem;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow);
        }

        .ai-faq-input-group {
            display: flex;
            gap: 1rem;
            /* margin-bottom: 1.5rem; */ /* Moved margin to form-group */
            align-items: stretch; /* Make items same height */
        }

        #aiQuestionInput {
            flex-grow: 1; /* Input takes available space */
        }

        #askAiBtn {
           white-space: nowrap; /* Prevent button text wrapping */
        }

        #aiAnswer {
            margin-top: 1rem;
            padding: 1.5rem;
            background-color: var(--background-white);
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            color: var(--text-primary);
            font-size: 0.95rem;
            min-height: 50px; /* Ensure some height even when empty */
            line-height: 1.7;
             white-space: pre-wrap; /* Preserve line breaks from AI */
        }

         #aiAnswer.loading, #aiPartsAnswer.loading { /* Added parts answer */
             color: var(--text-muted);
             display: flex;
             align-items: center;
             justify-content: center;
             font-style: italic;
         }

         #aiAnswer.error, #aiPartsAnswer.error { /* Added parts answer */
             background-color: #fee2e2;
             border-color: #fca5a5;
             color: #991b1b;
             font-style: normal;
         }

        /* --- AI Diagnoser Section Styles --- */
        .ai-diagnoser {
            padding-bottom: var(--section-padding); /* Add padding *bottom* only */
            background: var(--background-light); /* Match form section */
             /* border-top: 1px solid var(--border-color); */ /* Removed top border */
        }

        .ai-diagnoser-container {
           /* max-width: 800px; /* Wider container */
            margin: 0 auto;
            background: var(--background-white); /* White background for contrast */
            padding: 2.5rem;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow);
        }

         #aiDiagnosisAnswer {
            margin-top: 1.5rem;
            padding: 1.5rem;
            background-color: var(--background-light);
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            color: var(--text-primary);
            font-size: 0.95rem;
            min-height: 50px;
            line-height: 1.7;
            white-space: pre-wrap; /* Preserve line breaks */
        }

         #aiDiagnosisAnswer.loading {
             color: var(--text-muted);
             display: flex;
             align-items: center;
             justify-content: center;
             font-style: italic;
         }

         #aiDiagnosisAnswer.error {
             background-color: #fee2e2;
             border-color: #fca5a5;
             color: #991b1b;
             font-style: normal;
         }

         #aiDiagnosisAnswer ul {
             list-style-position: inside;
             margin-top: 1rem;
             padding-left: 0.5rem;
         }
         #aiDiagnosisAnswer li {
             margin-bottom: 0.5rem;
         }

         #bookDiagnosisBtn {
             margin-top: 1.5rem;
             width: 100%;
             display: none; /* Hidden by default */
         }

        /* --- AI Parts Finder Section Styles --- */
        .ai-parts-finder {
             padding: var(--section-padding);
             background: var(--background-white);
        }
        .ai-parts-container {
             background: var(--background-light);
             padding: 2.5rem;
             border-radius: var(--radius-lg);
             box-shadow: var(--shadow);
        }
         .parts-form-grid {
             display: grid;
             grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); /* Responsive grid */
             gap: 1rem 1.5rem; /* Row and column gap */
             margin-bottom: 1.5rem;
             align-items: end; /* Align items to bottom for button */
         }
         #aiPartsAnswer {
            margin-top: 1.5rem;
            padding: 1.5rem;
            background-color: var(--background-white);
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            color: var(--text-primary);
            font-size: 0.95rem;
            min-height: 50px;
            line-height: 1.7;
             white-space: pre-wrap; /* Preserve line breaks from AI */
         }
         #aiPartsAnswer strong { /* Style disclaimer */
             color: #b91c1c; /* Dark red */
         }


        /* Lead Capture Form */
        .lead-capture {
            padding: var(--section-padding);
            background: var(--background-light);
        }

        .form-container {
           /* max-width: 600px; /* Remove fixed max-width for form */
            margin: 0 auto;
            background: var(--background-white);
            padding: 2.5rem;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-lg);
        }

        .form-title {
            text-align: center;
            color: var(--accent-color);
            margin-bottom: 1rem;
        }

        .form-subtitle {
            text-align: center;
            color: var(--text-muted);
            margin-bottom: 2rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .form-control {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid var(--border-color);
            border-radius: var(--radius);
            font-size: 1rem;
            transition: border-color 0.3s ease;
            min-height: 44px;
             /* Ensure select dropdowns match input height */
             appearance: none; /* Needed for custom styling */
             background-color: var(--background-white); /* Match input bg */
        }
        /* Style select dropdown arrows */
        select.form-control {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%2367727e' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 0.75rem center;
            background-size: 1em;
            padding-right: 2.5rem; /* Space for arrow */
        }
        select.form-control:disabled {
            background-color: var(--background-light);
            cursor: not-allowed;
            opacity: 0.7;
        }


        .form-control:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(122, 139, 153, 0.1);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .service-options {
            display: grid;
            gap: 1rem;
        }

        .service-option {
            position: relative;
        }

        .service-option input[type="radio"] {
            position: absolute;
            opacity: 0;
            width: 0;
            height: 0;
        }

        .service-option-label {
            display: block;
            padding: 1rem;
            border: 2px solid var(--border-color);
            border-radius: var(--radius);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .service-option-label.recommended {
             border-color: #f59e0b;
             background-color: #fffbeb;
             box-shadow: 0 0 0 3px rgba(245, 158, 11, 0.3);
        }

        .service-option input[type="radio"]:checked + .service-option-label {
            border-color: var(--primary-color);
            background: rgba(122, 139, 153, 0.1);
        }

        .service-option-title {
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 0.25rem;
        }

        .service-option-desc {
            color: var(--text-muted);
            font-size: 0.875rem;
        }

        #aiRecommendation {
            margin-top: 1rem;
            padding: 1rem;
            background-color: #eff6ff;
            border: 1px solid #93c5fd;
            border-radius: var(--radius);
            color: #1e40af;
            font-size: 0.9rem;
            display: none;
        }
         #aiRecommendation.error {
             background-color: #fee2e2;
             border-color: #fca5a5;
             color: #991b1b;
         }

        .form-actions {
            display: grid;
            gap: 1rem;
            margin-top: 2rem;
        }

        .calendly-link {
            text-align: center;
            padding: 0.75rem;
            background: rgba(122, 139, 153, 0.1);
            border: 2px solid var(--primary-color);
            border-radius: var(--radius);
            text-decoration: none;
            color: var(--primary-color);
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .calendly-link:hover {
            background: var(--primary-color);
            color: var(--background-white);
        }

        /* Info Section with Images Styles */
        .info-section {
            padding: var(--section-padding);
            background: var(--background-white);
        }

        .info-grid-visual {
            display: grid;
            grid-template-columns: 1fr; /* Mobile-first */
            gap: 2rem;
            margin-top: 3rem;
        }

        @media (min-width: 768px) {
            .info-grid-visual {
                grid-template-columns: 1fr 1fr;
            }
        }

        .info-visual-card {
            background: var(--background-white);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .info-visual-card img {
            width: 100%;
            height: 280px;
            object-fit: cover;
            border-bottom: 1px solid var(--border-color);
        }

        .info-visual-content {
            padding: 2rem;
        }

        .info-visual-content h3 {
            color: var(--accent-color);
            margin-bottom: 1.5rem;
        }

        .info-list {
            list-style: none;
            padding: 0;
        }

        .info-list li {
            padding: 0.75rem 0;
            padding-left: 2rem;
            position: relative;
            color: var(--text-primary);
        }

        .info-list li:before {
            content: '✓';
            position: absolute;
            left: 0;
            top: 0.75rem;
            color: var(--primary-color);
            font-weight: 700;
            font-size: 1.25rem;
        }

        /* Footer */
        .footer {
            background: var(--accent-color);
            color: var(--background-white);
            padding: 3rem 0 1rem 0; /* Increased top padding, reduced bottom */
            text-align: center;
            margin-top: auto; /* Push footer to bottom */
        }

        .footer-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1.5rem; /* Increased gap */
            margin-bottom: 2rem; /* Add space above copyright */
        }
         .footer-links {
             display: flex;
             gap: 1.5rem;
             flex-wrap: wrap; /* Allow wrapping */
             justify-content: center; /* Center links */
         }
         .footer-links a {
             color: rgba(255, 255, 255, 0.8);
             text-decoration: none;
             font-weight: 500;
             transition: color 0.3s ease;
         }
         .footer-links a:hover {
             color: var(--background-white);
         }
        .footer-text {
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 0; /* Remove default paragraph margin */
        }
         .footer-copyright {
            color: rgba(255, 255, 255, 0.6); /* Lighter color for copyright */
            font-size: 0.875rem;
             margin-top: 1rem; /* Ensure space above if content is short */
         }


        /* Honeypot field - hidden from users */
        .honeypot {
            position: absolute;
            left: -5000px;
        }

        /* Mobile Responsiveness */
        @media (max-width: 900px) { /* Increased breakpoint */
             /* .header__nav is already handled */
             /* .tab-nav-container adjustments already exist */

            .services-grid {
                grid-template-columns: 1fr;
            }

            .areas-grid {
                gap: 0.5rem;
            }

            .area-badge {
                font-size: 1rem;
                padding: 0.5rem 1rem;
            }
             /* AI adjustments */
             .ai-faq-container, .ai-diagnoser-container, .form-container, .ai-parts-container { /* Added parts container */
                 padding: 1.5rem;
             }
             .ai-faq-input-group {
                 flex-direction: column;
                 align-items: stretch;
             }

            .form-row {
                grid-template-columns: 1fr;
            }
             .parts-form-grid {
                 grid-template-columns: 1fr; /* Stack on mobile */
             }

            .container {
                padding: 0 0.75rem;
            }

            h1 { font-size: 2rem; }
            h2 { font-size: 1.75rem; }
            h3 { font-size: 1.5rem; }

             .footer-links {
                 flex-direction: column; /* Stack links vertically */
                 gap: 1rem;
             }
        }

        @media (max-width: 480px) {
            .service-price {
                font-size: 2.5rem;
            }

            .btn {
                padding: 0.875rem 1rem;
                font-size: 0.9rem;
            }
             .common-options {
                 justify-content: center; /* Ensure centering on small screens */
             }
             .common-options-label {
                  text-align: center; /* Center label text */
             }
        }

        /* Focus styles for accessibility */
        .btn:focus,
        .cta-button:focus,
        .form-control:focus,
        .nav-link:focus,
        .tab-button:focus,
        .footer-links a:focus { /* Added footer links */
            outline: 2px solid var(--primary-color);
            outline-offset: 2px;
            border-radius: 2px; /* Slight radius for outline */
        }

        /* Loading states */
        .btn:disabled,
        .cta-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        /* Spinner for loading state */
        .spinner {
            display: inline-block;
            width: 1em;
            height: 1em;
            border: 2px solid currentColor;
            border-right-color: transparent;
            border-radius: 50%;
            animation: spinner-border .75s linear infinite;
            vertical-align: text-bottom;
            margin-left: 0.5em;
        }

        @keyframes spinner-border {
            to { transform: rotate(360deg); }
        }

        /* Ensure body takes full height for footer push */
        html, body {
            height: 100%;
        }
        body {
            display: flex;
            flex-direction: column;
        }
        main {
            flex: 1 0 auto; /* Allow main content to grow */
        }


    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header__content">
                <div class="header__logo" id="logoLink">
                    <img src="https://us.chat-img.sintra.ai/807c1317-1ece-4cd6-b4d7-bbc4fd5ac33e/be835d69-6252-4727-b6c7-009f38580d31/Photoroom_20251022_203721.png" alt="FultonTech7 Logo" class="logo"
                     onerror="this.onerror=null; this.src='https://placehold.co/48x48/7A8B99/FFFFFF?text=F7';">
                    <div class="header__title">FultonTech7</div>
                </div>
                <!-- Desktop Nav Items (visible > 900px) -->
                <div class="header__nav">
                     <a href="#" class="nav-link tab-switcher" data-target-tab="book">Book Appointment</a>
                </div>
                <!-- Mobile Menu Toggle (visible <= 900px) -->
                <button class="mobile-menu-toggle" aria-label="Toggle menu" aria-expanded="false">
                    <span class="hamburger-icon"></span>
                </button>
            </div>
        </div>
    </header>

    <!-- Tab Navigation (Becomes Mobile Menu Content) -->
    <nav class="tab-nav">
        <div class="tab-nav-container">
            <button class="tab-button active" data-target="home-pane">Home</button>
            <button class="tab-button" data-target="diagnoser-pane">AI Diagnoser</button>
            <button class="tab-button" data-target="faq-pane">AI Assistant</button>
            <button class="tab-button" data-target="parts-pane">Parts Finder</button> <!-- New Tab -->
            <button class="tab-button" data-target="book-pane">Book Now</button>
        </div>
    </nav>

    <!-- Main Content Area -->
    <main class="tab-content">

        <!-- Home Pane -->
        <div id="home-pane" class="tab-pane active">
            <!-- Hero Section -->
            <section class="hero">
              <img src="https://us.chat-img.sintra.ai/807c1317-1ece-4cd6-b4d7-bbc4fd5ac33e/0c26277b-6102-46d1-844c-a4c7a3bc95ad/image.png?w=1024&h=1024" alt="FultonTech7 Mobile Technician working under car hood" class="hero-background"
                onerror="this.onerror=null; this.src='https://placehold.co/1200x800/7A8B99/FFFFFF?text=FultonTech7+Mobile+Service';">

              <div class="hero-content">
                <h1>Professional Tune-Ups at Your Driveway</h1>
                <p>Licensed & insured mobile technician serving Fulton County</p>

                <div class="pricing">
                  <span>Basic: $250</span>
                  <span>Comprehensive: $350</span>
                  <span>Premium: $450</span>
                </div>
                <!-- Updated Link and removed tab-switcher functionality -->
                <a href="https://calendly.com/fultontech7/30min?month=2025-10" class="cta-button" target="_blank" rel="noopener noreferrer">
                  Book Same-Week Appointment
                </a>
              </div>
            </section>

            <!-- Services & Pricing Section -->
            <section id="services" class="services">
                <div class="container">
                    <div class="section-header">
                        <h2 class="section-title">Our Services</h2>
                        <p class="section-subtitle">Professional automotive tune-up services with transparent, up-front pricing</p>
                    </div>

                    <div class="services-grid">
                        <!-- Use tab-switcher class -->
                        <div class="service-card clickable-service-card tab-switcher" data-target-tab="book" data-service="basic">
                            <div class="service-price">$250</div>
                            <h3 class="service-name">Basic Tune-Up</h3>
                            <p class="service-description">Spark plugs, air filter, basic inspection</p>
                        </div>
                        <div class="service-card clickable-service-card tab-switcher" data-target-tab="book" data-service="comprehensive">
                            <div class="service-price">$350</div>
                            <h3 class="service-name">Comprehensive Tune-Up</h3>
                            <p class="service-description">Full service including filters, fluids, diagnostics</p>
                        </div>
                        <div class="service-card clickable-service-card tab-switcher" data-target-tab="book" data-service="premium">
                            <div class="service-price">$450</div>
                            <h3 class="service-name">Premium Tune-Up</h3>
                            <p class="service-description">Complete service with additional maintenance items</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Service Areas Section -->
            <section class="service-areas">
                <div class="container">
                    <div class="section-header">
                        <h2 class="section-title">Areas We Serve</h2>
                        <p class="section-subtitle">Professional mobile service throughout Fulton County</p>
                    </div>

                    <div class="areas-grid">
                         <!-- Use tab-switcher class -->
                        <div class="area-badge clickable-area-badge tab-switcher" data-target-tab="book" data-area="South Fulton">South Fulton</div>
                        <div class="area-badge clickable-area-badge tab-switcher" data-target-tab="book" data-area="Union City">Union City</div>
                        <div class="area-badge clickable-area-badge tab-switcher" data-target-tab="book" data-area="Fairburn">Fairburn</div>
                        <div class="area-badge clickable-area-badge tab-switcher" data-target-tab="book" data-area="Palmetto">Palmetto</div>
                    </div>
                </div>
            </section>

             <!-- Info Section -->
            <section class="info-section">
                <div class="container">
                    <div class="section-header">
                        <h2 class="section-title">Professional Service You Can Trust</h2>
                        <p class="section-subtitle">Expertise and convenience, delivered to your driveway.</p>
                    </div>

                    <div class="info-grid-visual">
                        <div class="info-visual-card">
                            <img src="https://us.chat-img.sintra.ai/807c1317-1ece-4cd6-b4d7-bbc4fd5ac33e/f7cb149a-d0eb-49a5-b2ef-459277d451ec/image.png?w=1024&h=1024" alt="Professional diagnostic tools and equipment"
                             onerror="this.onerror=null; this.src='https://placehold.co/600x400/1A2332/FFFFFF?text=Quality+Tools';">
                            <div class="info-visual-content">
                                <h3>Why Choose Us</h3>
                                <ul class="info-list">
                                    <li>Transparent, up-front pricing</li>
                                    <li>Mobile service — we come to you</li>
                                    <li>Licensed &amp; insured</li>
                                    <li>Same-week availability</li>
                                </ul>
                            </div>
                        </div>

                        <div class="info-visual-card">
                            <img src="https://us.chat-img.sintra.ai/807c1317-1ece-4cd6-b4d7-bbc4fd5ac33e/2d35cf6a-5e4f-4d3e-8039-61d3aec3bb49/image.png?w=1024&h=1024" alt="Happy customer receiving convenient mobile service"
                             onerror="this.onerror=null; this.src='https://placehold.co/600x400/7A8B99/FFFFFF?text=Happy+Customer';">
                            <div class="info-visual-content">
                                <h3>What to Expect</h3>
                                <ul class="info-list">
                                    <li>Quick confirmation after you submit</li>
                                    <li>Friendly reminders before the visit</li>
                                    <li>Professional service at your driveway</li>
                                    <li>Simple payment on completion</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div> <!-- End Home Pane -->

        <!-- AI Diagnoser Pane -->
        <div id="diagnoser-pane" class="tab-pane">
            <section id="ai-diagnoser" class="ai-diagnoser">
                 <!-- Use container--medium for narrower layout -->
                <div class="container container--medium">
                     <div class="section-header">
                         <h2 class="section-title">What's Wrong With My Car?</h2>
                         <p class="section-subtitle">Describe your car's symptoms or select common issues below.</p>
                     </div>
                     <div class="ai-diagnoser-container">
                         <div class="form-group">
                             <label for="vehicleInfoInput" class="form-label">Vehicle (Optional, but helpful)</label>
                             <input type="text" id="vehicleInfoInput" class="form-control" placeholder="e.g., 2018 Toyota Camry">
                         </div>
                         <div class="form-group">
                             <label for="symptomsInput" class="form-label">Describe Symptoms *</label>
                             <textarea id="symptomsInput" class="form-control" rows="4" placeholder="e.g., Car makes a loud rattling noise when I accelerate..." required></textarea>
                             <!-- Common Symptom Buttons -->
                             <div class="common-options">
                                <span class="common-options-label">Or, select common issues:</span>
                                <button type="button" class="btn btn--quick-option symptom-button">Check Engine Light On</button>
                                <button type="button" class="btn btn--quick-option symptom-button">Strange Noise (Rattling)</button>
                                <button type="button" class="btn btn--quick-option symptom-button">Strange Noise (Grinding)</button>
                                <button type="button" class="btn btn--quick-option symptom-button">Won't Start</button>
                                <button type="button" class="btn btn--quick-option symptom-button">Overheating</button>
                                <button type="button" class="btn btn--quick-option symptom-button">Brake Issues</button>
                                <button type="button" class="btn btn--quick-option symptom-button">Fluid Leak</button>
                                <button type="button" class="btn btn--quick-option symptom-button">Smells Like Gas</button>
                             </div>
                         </div>
                         <button type="button" id="getAiDiagnosisBtn" class="btn btn--primary btn--full-width">✨ Get AI Diagnosis</button>
                         <div class="form-group">
                             <div id="aiDiagnosisAnswer" style="display: none;"></div>
                             <!-- Use tab-switcher class -->
                             <button type="button" id="bookDiagnosisBtn" class="btn btn--secondary btn--full-width tab-switcher" data-target-tab="book">Book a Diagnostic Service</button>
                         </div>
                     </div>
                </div>
            </section>
        </div> <!-- End AI Diagnoser Pane -->

        <!-- AI FAQ Pane -->
        <div id="faq-pane" class="tab-pane">
            <section id="ai-faq" class="ai-faq">
                <!-- Use container--medium for narrower layout -->
                <div class="container container--medium">
                     <div class="section-header">
                         <h2 class="section-title">Have Questions? Ask Our AI Assistant!</h2>
                         <p class="section-subtitle">Get quick answers or select a common question below.</p>
                     </div>
                     <div class="ai-faq-container">
                         <div class="form-group">
                             <label for="aiQuestionInput" class="form-label">Your Question:</label>
                             <div class="ai-faq-input-group">
                                 <input type="text" id="aiQuestionInput" class="form-control" placeholder="e.g., What's included in the Basic Tune-Up?">
                                 <button type="button" id="askAiBtn" class="btn btn--primary">✨ Ask</button>
                             </div>
                             <!-- Common Question Buttons -->
                             <div class="common-options">
                                <span class="common-options-label">Or, select a common question:</span>
                                <button type="button" class="btn btn--quick-option faq-button">What services do you offer?</button>
                                <button type="button" class="btn btn--quick-option faq-button">What areas do you serve?</button>
                                <button type="button" class="btn btn--quick-option faq-button">How much is a Basic Tune-Up?</button>
                                <button type="button" class="btn btn--quick-option faq-button">How much is a Comprehensive Tune-Up?</button>
                                <button type="button" class="btn btn--quick-option faq-button">Are you licensed and insured?</button>
                                <button type="button" class="btn btn--quick-option faq-button">Do you work on weekends?</button>
                             </div>
                         </div>
                         <div class="form-group">
                             <label class="form-label">AI Answer:</label>
                             <div id="aiAnswer">Ask a question or click a button above to get an answer from our AI assistant.</div>
                         </div>
                     </div>
                </div>
            </section>
        </div> <!-- End AI FAQ Pane -->

         <!-- AI Parts Finder Pane -->
        <div id="parts-pane" class="tab-pane">
            <section class="ai-parts-finder">
                <div class="container container--medium">
                    <div class="section-header">
                        <h2 class="section-title">AI Parts & Fluids Finder</h2>
                        <p class="section-subtitle">Get general guidance on parts or fluids for your vehicle.</p>
                    </div>
                    <div class="ai-parts-container">
                        <div class="parts-form-grid">
                            <div class="form-group">
                                <label class="form-label" for="partsVehicleYear">Vehicle Year *</label>
                                <select id="partsVehicleYear" class="form-control" required>
                                    <option value="">Select Year</option>
                                    <!-- Options populated by JS -->
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="partsVehicleMake">Vehicle Make *</label>
                                 <select id="partsVehicleMake" class="form-control" required>
                                     <option value="">Select Make</option>
                                     <!-- Options populated by JS -->
                                 </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="partsVehicleModel">Vehicle Model *</label>
                                 <select id="partsVehicleModel" class="form-control" required disabled>
                                     <option value="">Select Make First</option>
                                     <!-- Options populated by JS -->
                                 </select>
                            </div>
                             <div class="form-group">
                                 <label class="form-label" for="partsType">Part/Fluid Type *</label>
                                 <select id="partsType" class="form-control" required>
                                     <option value="">Select Type</option>
                                     <option value="Engine Oil">Engine Oil</option>
                                     <option value="Oil Filter">Oil Filter</option>
                                     <option value="Engine Air Filter">Engine Air Filter</option>
                                     <option value="Cabin Air Filter">Cabin Air Filter</option>
                                     <option value="Spark Plugs">Spark Plugs</option>
                                     <option value="Brake Fluid">Brake Fluid</option>
                                     <option value="Coolant/Antifreeze">Coolant/Antifreeze</option>
                                     <option value="Wiper Blades">Wiper Blades</option>
                                     <option value="Battery">Battery</option>
                                     <!-- Add more common items as needed -->
                                 </select>
                            </div>
                            <div class="form-group" style="grid-column: 1 / -1;"> <!-- Button spans full width potentially -->
                                <button type="button" id="findPartsBtn" class="btn btn--primary btn--full">✨ Find Info</button>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">AI Guidance:</label>
                            <div id="aiPartsAnswer">Select your vehicle and the part/fluid type above.</div>
                        </div>
                    </div>
                </div>
            </section>
        </div> <!-- End AI Parts Finder Pane -->

        <!-- Booking Pane -->
        <div id="book-pane" class="tab-pane">
             <section id="book-appointment" class="lead-capture">
                 <!-- Use container--medium for narrower layout -->
                <div class="container container--medium">
                    <div class="form-container">
                        <h2 class="form-title">Book Your Appointment</h2>
                        <p class="form-subtitle">We respond to all requests within 2 hours during business hours</p>

                        <form id="appointmentForm" name="appointment" method="POST" data-netlify="true" netlify-honeypot="bot-field">
                            <div class="honeypot">
                                <label>Don't fill this out if you're human: <input name="bot-field" /></label>
                            </div>
                            <input type="hidden" name="form-name" value="appointment">

                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label" for="customerName">Customer Name *</label>
                                    <input type="text" id="customerName" name="customerName" class="form-control" required>
                                </div>
                                <div class="form-group">
                                    <label class="form-label" for="phone">Phone Number *</label>
                                    <input type="tel" id="phone" name="phone" class="form-control" placeholder="(XXX) XXX-XXXX" required> <!-- Updated placeholder -->
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="form-label" for="email">Email Address *</label>
                                <input type="email" id="email" name="email" class="form-control" required>
                            </div>

                            <div class="form-group">
                                <label class="form-label" for="leadSource">How did you hear about us? *</label>
                                <select id="leadSource" name="leadSource" class="form-control" required>
                                    <option value="">Select source</option>
                                    <option value="Nextdoor">Nextdoor</option>
                                    <option value="Facebook">Facebook</option>
                                    <option value="Referral">Referral</option>
                                    <option value="Direct">Direct</option>
                                    <option value="Other">Other</option> <!-- Added Other -->
                                </select>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label" for="vehicleYear">Vehicle Year *</label>
                                    <select id="vehicleYear" name="vehicleYear" class="form-control" required>
                                        <option value="">Select Year</option>
                                        <!-- Options populated by JS -->
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label" for="vehicleMake">Vehicle Make *</label>
                                     <select id="vehicleMake" name="vehicleMake" class="form-control" required>
                                         <option value="">Select Make</option>
                                         <!-- Options populated by JS -->
                                     </select>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="form-label" for="vehicleModel">Vehicle Model *</label>
                                 <select id="vehicleModel" name="vehicleModel" class="form-control" required disabled>
                                     <option value="">Select Make First</option>
                                     <!-- Options populated by JS based on Make -->
                                 </select>
                            </div>

                             <div class="form-group">
                                <label class="form-label" for="issueDescription">Describe the Issue (Optional)</label>
                                <textarea id="issueDescription" name="issueDescription" class="form-control" rows="4" placeholder="e.g., Engine light is on, rough idle, need regular maintenance..."></textarea>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Service Needed *</label>
                                 <button type="button" id="getAiRecommendationBtn" class="btn btn--secondary" style="margin-bottom: 1rem; width: 100%;">
                                     ✨ Help Me Choose a Service
                                 </button>
                                 <div id="aiRecommendation"></div>
                                <div class="service-options">
                                    <div class="service-option">
                                        <input type="radio" id="basic" name="serviceType" value="Basic Tune-Up - $250" required>
                                        <label for="basic" class="service-option-label">
                                            <div class="service-option-title">Basic Tune-Up - $250</div>
                                            <div class="service-option-desc">Spark plugs, air filter, basic inspection</div>
                                        </label>
                                    </div>
                                    <div class="service-option">
                                        <input type="radio" id="comprehensive" name="serviceType" value="Comprehensive Tune-Up - $350" required>
                                        <label for="comprehensive" class="service-option-label">
                                            <div class="service-option-title">Comprehensive Tune-Up - $350</div>
                                            <div class="service-option-desc">Full service including filters, fluids, diagnostics</div>
                                        </label>
                                    </div>
                                    <div class="service-option">
                                        <input type="radio" id="premium" name="serviceType" value="Premium Tune-Up - $450" required>
                                        <label for="premium" class="service-option-label">
                                            <div class="service-option-title">Premium Tune-Up - $450</div>
                                            <div class="service-option-desc">Complete service with additional maintenance items</div>
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label" for="appointmentDate">Preferred Appointment Date *</label>
                                    <input type="date" id="appointmentDate" name="appointmentDate" class="form-control" required>
                                </div>
                                <div class="form-group">
                                    <label class="form-label" for="appointmentTime">Preferred Time *</label>
                                    <input type="time" id="appointmentTime" name="appointmentTime" class="form-control" required>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="form-label" for="serviceAddress">Service Address *</label>
                                <textarea id="serviceAddress" name="serviceAddress" class="form-control" rows="3" placeholder="Full address where service will be performed..." required></textarea>
                            </div>

                            <div class="form-actions">
                                <button type="submit" class="btn btn--primary btn--full">Submit Request</button>
                                <a href="https://calendly.com/fultontech7/30min" target="_blank" class="calendly-link">
                                    📅 Book via Calendly
                                </a>
                            </div>
                        </form>
                    </div>
                </div>
            </section>
        </div> <!-- End Booking Pane -->

    </main> <!-- End Tab Content Area -->


    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-links">
                    <!-- Updated href with actual phone/email -->
                    <a href="tel:+17739999783">773-999-9783</a>
                    <a href="mailto:fultontech7@gmail.com">fultontech7@gmail.com</a>
                    <!-- Add links to social media if desired -->
                    <!-- <a href="#" target="_blank" rel="noopener noreferrer">Facebook</a> -->
                </div>
                <p class="footer-text">Serving South Fulton, Union City, Fairburn, Palmetto</p>
            </div>
            <!-- Copyright notice -->
             <p class="footer-copyright">&copy; <span id="currentYear">2025</span> FultonTech7. All rights reserved.</p>
        </div>
    </footer>

    <script>
         // --- Vehicle Make/Model Data ---
         const vehicleData = {
            "Toyota": ["Camry", "Corolla", "RAV4", "Highlander", "Tacoma", "Sienna", "4Runner", "Prius", "Other"],
            "Honda": ["Civic", "Accord", "CR-V", "Pilot", "Odyssey", "HR-V", "Ridgeline", "Other"],
            "Ford": ["F-150", "Explorer", "Escape", "Mustang", "Edge", "Bronco", "Ranger", "Expedition", "Other"],
            "Chevrolet": ["Silverado", "Equinox", "Tahoe", "Malibu", "Traverse", "Blazer", "Suburban", "Camaro", "Other"],
            "Nissan": ["Altima", "Rogue", "Sentra", "Maxima", "Pathfinder", "Murano", "Titan", "Frontier", "Other"],
            "Jeep": ["Grand Cherokee", "Wrangler", "Cherokee", "Compass", "Renegade", "Other"],
            "Hyundai": ["Elantra", "Sonata", "Tucson", "Santa Fe", "Palisade", "Kona", "Other"],
            "Kia": ["Optima/K5", "Sorento", "Sportage", "Telluride", "Forte", "Soul", "Other"],
            "BMW": ["3 Series", "5 Series", "X3", "X5", "X1", "7 Series", "Other"],
            "Mercedes-Benz": ["C-Class", "E-Class", "GLC", "GLE", "S-Class", "Other"],
            "Lexus": ["RX", "ES", "NX", "IS", "GX", "Other"],
            "Subaru": ["Outback", "Forester", "Crosstrek", "Ascent", "Impreza", "Other"],
            "GMC": ["Sierra", "Yukon", "Acadia", "Terrain", "Other"],
            "Ram": ["1500", "2500", "3500", "Other"],
            "Volkswagen": ["Jetta", "Tiguan", "Atlas", "Passat", "Golf", "Other"],
            "Mazda": ["CX-5", "Mazda3", "CX-9", "Mazda6", "Other"],
            "Dodge": ["Charger", "Challenger", "Durango", "Other"],
            "Chrysler": ["Pacifica", "300", "Other"],
            "Acura": ["MDX", "RDX", "TLX", "Integra", "Other"],
            "Audi": ["Q5", "Q7", "A4", "A6", "Other"],
            "Cadillac": ["Escalade", "XT5", "XT4", "CT5", "Other"],
            "Infiniti": ["QX60", "QX80", "Q50", "Other"],
            "Volvo": ["XC90", "XC60", "S60", "Other"],
            "Other": ["Other"] // Fallback
         };


        // --- Gemini API Call Function ---
        async function callGeminiApi(prompt, useSearch = false) { // Added useSearch flag
            const apiKey = "AIzaSyCnhz2MmM_zTFgKzLw7xWYDRWHhKufXce4"; // <<< HARDCODED KEY
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;

            const payload = {
                contents: [{ parts: [{ text: prompt }] }],
            };

            // Conditionally add search grounding tool
            if (useSearch) {
                payload.tools = [{ "google_search": {} }];
                 console.log("Using Google Search grounding for this API call.");
            } else {
                 console.log("Not using Google Search grounding for this API call.");
            }


            console.log("Sending prompt to Gemini:", prompt);
            let attempts = 0; const maxAttempts = 5; let delay = 1000;
            while (attempts < maxAttempts) {
                try {
                    const response = await fetch(apiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
                    if (!response.ok) {
                        if (response.status === 429 || response.status >= 500) {
                            console.warn(`API call failed with status ${response.status}. Retrying in ${delay / 1000}s...`);
                            await new Promise(resolve => setTimeout(resolve, delay)); delay *= 2; attempts++; continue;
                        } else {
                            const errorBody = await response.text(); console.error(`API Error ${response.status}:`, errorBody); throw new Error(`API error: ${response.status} - ${errorBody}`);
                        }
                    }
                    const result = await response.json(); console.log("Received response from Gemini:", result);
                    const candidate = result.candidates?.[0];

                    // --- Grounding Metadata Extraction (if search was used) ---
                    let sources = [];
                     if (useSearch && candidate?.groundingMetadata?.groundingAttributions) {
                        sources = candidate.groundingMetadata.groundingAttributions
                            .map(attr => ({ uri: attr.web?.uri, title: attr.web?.title }))
                            .filter(source => source.uri && source.title);
                         console.log("Grounding Sources:", sources);
                         // Note: We are not displaying sources in the current UI, but extracting them is good practice.
                    }
                    // --- ---

                    if (candidate && candidate.content?.parts?.[0]?.text) {
                        // Return both text and sources (sources will be empty if search wasn't used)
                        return { text: candidate.content.parts[0].text.trim(), sources: sources };
                    } else {
                         console.error("Unexpected API response structure:", result);
                         const finishReason = candidate?.finishReason;
                         if (finishReason && finishReason !== "STOP") { throw new Error(`API generation stopped due to ${finishReason}.`); }
                        throw new Error("Could not extract text from API response.");
                    }
                } catch (error) {
                    console.error("Error during API call attempt:", error);
                     if (attempts >= maxAttempts - 1) { throw error; }
                     console.warn(`Network or processing error. Retrying in ${delay / 1000}s...`);
                     await new Promise(resolve => setTimeout(resolve, delay)); delay *= 2; attempts++;
                }
            }
            throw new Error(`API call failed after ${maxAttempts} attempts.`);
        }

        // --- Mobile Menu Toggle ---
        function initializeMobileMenu() {
             const toggleButton = document.querySelector('.mobile-menu-toggle');
             const mobileMenu = document.querySelector('.tab-nav'); // The tab nav becomes the mobile menu

             if (toggleButton && mobileMenu) {
                 toggleButton.addEventListener('click', () => {
                      const isOpen = mobileMenu.classList.toggle('mobile-menu-open');
                      toggleButton.classList.toggle('open', isOpen);
                      toggleButton.setAttribute('aria-expanded', isOpen);
                 });
             }
        }

         // --- Close Mobile Menu ---
         function closeMobileMenu() {
             const toggleButton = document.querySelector('.mobile-menu-toggle');
             const mobileMenu = document.querySelector('.tab-nav');
             if (mobileMenu && mobileMenu.classList.contains('mobile-menu-open')) {
                  mobileMenu.classList.remove('mobile-menu-open');
                  toggleButton.classList.remove('open');
                  toggleButton.setAttribute('aria-expanded', 'false');
             }
         }

        // --- Tab Switching Logic ---
        function switchTab(targetId) {
            document.querySelectorAll('.tab-pane').forEach(pane => pane.classList.remove('active'));
            document.querySelectorAll('.tab-button').forEach(button => button.classList.remove('active'));

            const targetPane = document.getElementById(targetId);
            const targetButton = document.querySelector(`.tab-button[data-target="${targetId}"]`);

            if (targetPane) targetPane.classList.add('active');
            if (targetButton) targetButton.classList.add('active');
            window.scrollTo({ top: 0, behavior: 'smooth' }); // Scroll to top when switching tabs
            closeMobileMenu(); // Close mobile menu after switching
        }

        // --- Initialize the application ---
        document.addEventListener('DOMContentLoaded', () => initializeApp());

        function initializeApp() {
            const currentYearEl = document.getElementById('currentYear');
            // Update current year dynamically only if the element exists and the content is the default '2025'
            if (currentYearEl && currentYearEl.textContent === '2025') {
                 currentYearEl.textContent = new Date().getFullYear();
            }
            // Populate shared dropdowns first
            populateVehicleYears();
            populateVehicleMakes();

            // Initialize form elements and interactions
            initializeMakeModelDropdowns('#vehicleMake', '#vehicleModel'); // For booking form
             initializeMakeModelDropdowns('#partsVehicleMake', '#partsVehicleModel'); // For parts finder
             populatePartsFinderDropdowns(); // Populate year/make for parts finder too

            setMinimumDate();
            initializeForm();
            initializePhoneFormatting();
            initializeSmoothScrolling();
            initializeAIRecommendation();
            initializeHeaderLogoLink();
            initializeAIAssistant();
            initializeAIDiagnoser();
            initializePartsFinder(); // Initialize the new tool
            initializeMobileMenu();
            initializeTabNavigation();
        }

         // --- Populate Year/Make for Parts Finder ---
         function populatePartsFinderDropdowns() {
             const yearSelect = document.getElementById('partsVehicleYear');
             const makeSelect = document.getElementById('partsVehicleMake');

             if (yearSelect) {
                 const currentYear = new Date().getFullYear();
                 for (let year = currentYear; year >= 1990; year--) { // Go back further for parts
                     const option = document.createElement('option'); option.value = year; option.textContent = year; yearSelect.appendChild(option);
                 }
             }
             if (makeSelect) {
                 const makes = Object.keys(vehicleData).sort();
                 makes.forEach(make => {
                     const option = document.createElement('option'); option.value = make; option.textContent = make; makeSelect.appendChild(option);
                 });
             }
         }


        // --- Populate Vehicle Makes Dropdown ---
        function populateVehicleMakes() {
             // Populate for booking form
             const makeSelectBooking = document.getElementById('vehicleMake');
             if (makeSelectBooking) {
                 const makes = Object.keys(vehicleData).sort();
                 makes.forEach(make => {
                     const option = document.createElement('option'); option.value = make; option.textContent = make; makeSelectBooking.appendChild(option);
                 });
             }
             // Populate for parts finder (already handled in populatePartsFinderDropdowns)
        }

        // --- Initialize Make/Model Dropdown Interaction (Generic) ---
        function initializeMakeModelDropdowns(makeSelector, modelSelector) {
            const makeSelect = document.querySelector(makeSelector);
            const modelSelect = document.querySelector(modelSelector);

            if (!makeSelect || !modelSelect) {
                 console.warn(`Make/Model dropdowns not found for selectors: ${makeSelector}, ${modelSelector}`);
                 return;
            }

            makeSelect.addEventListener('change', () => {
                const selectedMake = makeSelect.value;
                modelSelect.innerHTML = ''; // Clear existing model options
                modelSelect.disabled = true; // Disable until populated

                if (selectedMake && vehicleData[selectedMake]) {
                    const defaultOption = document.createElement('option');
                    defaultOption.value = ""; defaultOption.textContent = "Select Model"; modelSelect.appendChild(defaultOption);

                    vehicleData[selectedMake].forEach(model => {
                        const option = document.createElement('option'); option.value = model; option.textContent = model; modelSelect.appendChild(option);
                    });
                    modelSelect.disabled = false;
                } else {
                    const defaultOption = document.createElement('option');
                    defaultOption.value = ""; defaultOption.textContent = selectedMake ? "Models not listed" : "Select Make First"; modelSelect.appendChild(defaultOption);
                }
            });
        }


        // --- Tab Navigation Initialization ---
        function initializeTabNavigation() {
            const tabButtons = document.querySelectorAll('.tab-button');
            const tabSwitchers = document.querySelectorAll('.tab-switcher'); // Links/Buttons that trigger tab switches

            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    switchTab(button.dataset.target); // switchTab now handles closing mobile menu
                });
            });

            tabSwitchers.forEach(switcher => {
                switcher.addEventListener('click', (e) => {
                    e.preventDefault(); // Prevent default link behavior
                    const targetTabShortName = switcher.dataset.targetTab; // e.g., "book"
                    const targetTabId = targetTabShortName ? targetTabShortName + '-pane' : null; // e.g., "book-pane"

                    if (!targetTabId) {
                        console.warn('Tab switcher missing data-target-tab:', switcher);
                        return;
                    }

                    switchTab(targetTabId); // Use the main function

                    // --- Handle specific actions after tab switch ---
                    const service = switcher.dataset.service;
                    const area = switcher.dataset.area;

                    setTimeout(() => { // Use setTimeout to allow tab switch animation/rendering
                        if (service) { // If it's a service card click
                            const radio = document.getElementById(service);
                            if (radio) radio.checked = true;
                            const serviceOptions = document.querySelector('#book-pane .service-options');
                            if (serviceOptions) serviceOptions.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        } else if (area) { // If it's an area badge click
                            const addressField = document.getElementById('serviceAddress');
                            if (addressField) {
                                addressField.value = area + ", GA";
                                addressField.focus();
                                addressField.scrollIntoView({ behavior: 'smooth', block: 'center' });
                            }
                        } else if (switcher.id === 'bookDiagnosisBtn') { // If it's the Book Diagnosis button
                            const radio = document.getElementById('comprehensive');
                            const issueDescriptionField = document.getElementById('issueDescription');
                            const symptomsInput = document.getElementById('symptomsInput');
                            const vehicleInfoInput = document.getElementById('vehicleInfoInput');

                            if (radio) radio.checked = true;
                            if(issueDescriptionField && symptomsInput && symptomsInput.value) {
                                const diagPrefix = "From AI Diagnoser:";
                                if (!issueDescriptionField.value || issueDescriptionField.value.startsWith(diagPrefix)) {
                                    issueDescriptionField.value = `${diagPrefix}\nVehicle: ${vehicleInfoInput?.value || 'Not specified'}\nSymptoms: ${symptomsInput.value}`;
                                }
                                issueDescriptionField.focus();
                                issueDescriptionField.scrollIntoView({ behavior: 'smooth', block: 'center' });
                            } else if (issueDescriptionField) {
                                issueDescriptionField.scrollIntoView({ behavior: 'smooth', block: 'center' });
                            }
                        } else if (targetTabId === 'book-pane') { // If just switching to book tab (e.g., header link)
                           const formContainer = document.querySelector('#book-pane .form-container');
                           if (formContainer) {
                                formContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
                           }
                        }
                    }, 50); // Small delay
                });
            });

             // Handle logo click to go to Home tab (Simplified)
             const logoLink = document.getElementById('logoLink');
             if (logoLink) {
                 logoLink.addEventListener('click', (e) => {
                     e.preventDefault();
                     const homeButton = document.querySelector('.tab-button[data-target="home-pane"]');
                     if (homeButton) homeButton.click(); // This will trigger switchTab
                 });
             }
        }


        // --- AI Diagnoser Logic ---
        function initializeAIDiagnoser() {
            const getDiagBtn = document.getElementById('getAiDiagnosisBtn');
            const vehicleInfoInput = document.getElementById('vehicleInfoInput');
            const symptomsInput = document.getElementById('symptomsInput');
            const answerDiv = document.getElementById('aiDiagnosisAnswer');
            const bookBtn = document.getElementById('bookDiagnosisBtn');
            const symptomButtons = document.querySelectorAll('.symptom-button'); // Get symptom buttons

            if (!getDiagBtn || !symptomsInput || !answerDiv || !bookBtn) {
                console.warn("AI Diagnoser elements not found, feature disabled.");
                return;
            }
            getDiagBtn.addEventListener('click', handleGetDiagnosis);

            // Add event listeners for symptom buttons
            symptomButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const currentText = symptomsInput.value.trim();
                    const symptom = button.textContent.trim();
                    // Append with a separator if text already exists
                    symptomsInput.value = currentText ? `${currentText}, ${symptom}` : symptom;
                    symptomsInput.focus(); // Bring focus to the textarea
                     // Optional: Visual feedback
                     symptomsInput.style.borderColor = 'var(--primary-color)';
                     setTimeout(() => { symptomsInput.style.borderColor = ''; }, 500);
                });
            });

            async function handleGetDiagnosis() {
                const symptoms = symptomsInput.value.trim();
                const vehicle = vehicleInfoInput.value.trim() || 'Not specified';
                if (!symptoms) {
                    answerDiv.innerHTML = 'Please describe your car\'s symptoms or select common issues.';
                    answerDiv.className = 'error';
                    answerDiv.style.display = 'block';
                    bookBtn.style.display = 'none';
                    return;
                }
                const prompt = `You are an expert mechanic AI for FultonTech7. A user is experiencing car trouble.\nVehicle: ${vehicle}\nSymptoms: "${symptoms}"\n\nBased *only* on these symptoms, what are the 2-3 most likely problems? For each problem, provide a 1-sentence explanation. Do not give repair advice.\nStart your answer with "Based on your description, here are a few possibilities (this is a preliminary diagnosis, a full inspection is needed):"\nFormat the answer as an unordered list (using * for bullet points).`;

                getDiagBtn.disabled = true;
                getDiagBtn.innerHTML = '✨ Diagnosing... <span class="spinner"></span>';
                answerDiv.innerHTML = '<span class="spinner"></span> Analyzing symptoms...';
                answerDiv.className = 'loading';
                answerDiv.style.display = 'block';
                bookBtn.style.display = 'none';

                try {
                    const { text: answer } = await callGeminiApi(prompt, false); // No search needed here
                    let htmlAnswer = answer.replace(/^\* (.*)$/gm, '<li>$1</li>');
                    if (htmlAnswer.includes('<li>')) {
                        const firstLi = htmlAnswer.indexOf('<li>');
                        const lastLi = htmlAnswer.lastIndexOf('</li>');
                        if (firstLi !== -1 && lastLi !== -1) {
                            htmlAnswer = htmlAnswer.substring(0, firstLi) +
                                      '<ul>' +
                                      htmlAnswer.substring(firstLi, lastLi + 5) +
                                      '</ul>' +
                                      htmlAnswer.substring(lastLi + 5);
                        }
                    }
                    answerDiv.innerHTML = htmlAnswer;
                    answerDiv.className = '';
                    bookBtn.style.display = 'block'; // Show the "Book" button
                } catch (error) {
                    console.error("Error getting AI diagnosis:", error);
                    answerDiv.textContent = `Sorry, I couldn't get a diagnosis right now. Please try again or fill out the form below. Error: ${error.message}`;
                    answerDiv.className = 'error';
                    bookBtn.style.display = 'none';
                } finally {
                    getDiagBtn.disabled = false;
                    getDiagBtn.innerHTML = '✨ Get AI Diagnosis';
                }
            }
        }


        // --- AI FAQ Assistant Logic ---
        function initializeAIAssistant() {
            const askBtn = document.getElementById('askAiBtn');
            const questionInput = document.getElementById('aiQuestionInput');
            const answerDiv = document.getElementById('aiAnswer');
            const faqButtons = document.querySelectorAll('.faq-button'); // Get FAQ buttons

            if (!askBtn || !questionInput || !answerDiv) { console.warn("AI Assistant elements not found, feature disabled."); return; }
            askBtn.addEventListener('click', handleAskAI);
            questionInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') handleAskAI(); });

             // Add event listeners for FAQ buttons
            faqButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const question = button.textContent.trim();
                    questionInput.value = question;
                    // Automatically ask the question after a short delay
                    setTimeout(handleAskAI, 100);
                });
            });


            async function handleAskAI() {
                 const question = questionInput.value.trim();
                 if (!question) { answerDiv.textContent = 'Please enter a question or select one below.'; answerDiv.className = 'error'; return; }
                 const servicesOffered = `- Basic Tune-Up ($250): Spark plugs, air filter, basic inspection.\n- Comprehensive Tune-Up ($350): Full service including filters, fluids, diagnostics, spark plugs.\n- Premium Tune-Up ($450): Comprehensive + additional items like fuel system/throttle body cleaning.`;
                 const areasServed = "South Fulton, Union City, Fairburn, Palmetto in Fulton County, GA.";
                 const keyFeatures = "Mobile service (we come to you), transparent pricing, licensed & insured, same-week availability.";
                 const prompt = `You are a helpful AI assistant for FultonTech7, a mobile auto technician in Fulton County, GA.\nAnswer the user's question based on the following information about the business and general automotive knowledge. Keep answers concise, friendly, and helpful (1-3 sentences). If the question is completely unrelated to car maintenance or FultonTech7's services, politely state that you can only answer questions about those topics.\n\nBusiness Information:\n- Services: ${servicesOffered}\n- Service Area: ${areasServed}\n- Key Features: ${keyFeatures}\n- Technician comes to the customer's location (driveway).\n- Customers can book online via form or Calendly.\n- Response time for requests is typically within 2 hours during business hours.\n\nUser Question: "${question}"\n\nAnswer:`;
                 askBtn.disabled = true; askBtn.innerHTML = '✨ Asking... <span class="spinner"></span>';
                 answerDiv.innerHTML = '<span class="spinner"></span> Getting answer...'; answerDiv.className = 'loading';
                 try {
                     const { text: answer } = await callGeminiApi(prompt, false); // No search needed
                     answerDiv.textContent = answer; answerDiv.className = '';
                 } catch (error) {
                     console.error("Error getting AI answer:", error);
                     answerDiv.textContent = `Sorry, I couldn't get an answer right now. Please try again later or contact us directly. Error: ${error.message}`;
                     answerDiv.className = 'error';
                 } finally {
                     askBtn.disabled = false; askBtn.innerHTML = '✨ Ask'; // Shorter text
                 }
            }
        }

         // --- AI Parts Finder Logic ---
         function initializePartsFinder() {
            const findBtn = document.getElementById('findPartsBtn');
            const yearSelect = document.getElementById('partsVehicleYear');
            const makeSelect = document.getElementById('partsVehicleMake');
            const modelSelect = document.getElementById('partsVehicleModel');
            const typeSelect = document.getElementById('partsType');
            const answerDiv = document.getElementById('aiPartsAnswer');

            if (!findBtn || !yearSelect || !makeSelect || !modelSelect || !typeSelect || !answerDiv) {
                console.warn("AI Parts Finder elements not found, feature disabled.");
                return;
            }

            findBtn.addEventListener('click', handleFindParts);

            async function handleFindParts() {
                const year = yearSelect.value;
                const make = makeSelect.value;
                const model = modelSelect.value;
                const partType = typeSelect.value;

                if (!year || !make || !model || !partType) {
                    answerDiv.textContent = 'Please select Vehicle Year, Make, Model, and Part/Fluid Type.';
                    answerDiv.className = 'error';
                    return;
                }

                const prompt = `Act as an auto parts specialist. For a ${year} ${make} ${model}, find general information about the required ${partType}. Provide common specifications (like oil viscosity/type, filter size/type if known, spark plug type/gap, battery group size, etc.). If specific part numbers are easily found via search, mention common ones as examples, but prioritize specifications. Also, mention common places to purchase these parts (e.g., local auto parts stores, online retailers). Start the response with "For a ${year} ${make} ${model}, here's some general guidance on ${partType}:". Crucially, end the response *exactly* with the following disclaimer on a new line: "**Disclaimer:** This is general information. Always verify with your owner's manual or a professional like FultonTech7 before purchasing parts. FultonTech7 can also supply the correct parts during your service appointment."`;

                findBtn.disabled = true;
                findBtn.innerHTML = '✨ Finding... <span class="spinner"></span>';
                answerDiv.innerHTML = '<span class="spinner"></span> Searching for parts info...';
                answerDiv.className = 'loading';

                try {
                    // Use search grounding for this tool
                    const { text: answer } = await callGeminiApi(prompt, true);
                    answerDiv.innerHTML = answer.replace(/\n/g, '<br>'); // Preserve line breaks in HTML
                    answerDiv.className = '';
                } catch (error) {
                    console.error("Error getting parts info:", error);
                    answerDiv.textContent = `Sorry, I couldn't find information right now. Please try again or consult your owner's manual. Error: ${error.message}`;
                    answerDiv.className = 'error';
                } finally {
                    findBtn.disabled = false;
                    findBtn.innerHTML = '✨ Find Info';
                }
            }
         }


        // --- Other Initialization Functions ---
        function initializeHeaderLogoLink() {
           // Logic moved to initializeTabNavigation
        }
        function initializeServiceCardClicks() {
            // Logic moved to initializeTabNavigation (handled by .tab-switcher)
        }
        function initializeAreaBadgeClicks() {
           // Logic moved to initializeTabNavigation (handled by .tab-switcher)
        }
        function populateVehicleYears() {
             // Populate for booking form (recent years)
            const yearSelectBooking = document.getElementById('vehicleYear');
             if (yearSelectBooking) {
                 const currentYear = new Date().getFullYear();
                 for (let year = currentYear; year >= 2010; year--) { // Adjust range if needed
                     const option = document.createElement('option'); option.value = year; option.textContent = year; yearSelectBooking.appendChild(option);
                 }
             }
             // Populate for parts finder (handled in populatePartsFinderDropdowns)
        }
        function setMinimumDate() {
            const dateInput = document.getElementById('appointmentDate'); if (!dateInput) return;
            const today = new Date(); today.setDate(today.getDate() + 1);
            dateInput.min = today.toISOString().split('T')[0];
        }
        function initializePhoneFormatting() {
            // Ensure phone input exists before adding listener
             const bookPane = document.getElementById('book-pane');
             const phoneInput = bookPane ? bookPane.querySelector('#phone') : null;
             if (!phoneInput) return;

            phoneInput.addEventListener('input', (e) => {
                let value = e.target.value.replace(/\D/g, '').slice(0, 10);
                if (value.length >= 7) value = `(${value.slice(0, 3)}) ${value.slice(3, 6)}-${value.slice(6)}`;
                else if (value.length >= 4) value = `(${value.slice(0, 3)}) ${value.slice(3)}`;
                else if (value.length >= 1) value = `(${value.slice(0, 3)}`;
                e.target.value = value;
            });
        }
        function initializeForm() {
            const form = document.getElementById('appointmentForm'); if (!form) return;
            form.addEventListener('submit', (e) => {
                if (!validateForm()) { e.preventDefault(); return; }
                const submitBtn = form.querySelector('button[type="submit"]');
                if (submitBtn) { submitBtn.disabled = true; submitBtn.textContent = 'Submitting...'; }
            });
        }
         function validateForm() {
            const activeBookPane = document.getElementById('book-pane');
            const form = activeBookPane ? activeBookPane.querySelector('#appointmentForm') : null;
            if (!form) { console.error("Booking form not found in the active pane."); return false; }

            let isValid = true; let firstErrorField = null;
            form.querySelectorAll('.service-option-label').forEach(label => label.style.borderColor = '');
            const serviceOptionsContainer = form.querySelector('.service-options');
            if (serviceOptionsContainer) serviceOptionsContainer.style.border = '';

            form.querySelectorAll('[required]').forEach(field => {
                 // Skip fields not directly within the main form container if necessary
                 if (!field.closest('#appointmentForm')) return;
                 // Skip specific non-input required elements if needed

                let fieldInvalid = false;
                if (field.type === 'radio' && field.name === 'serviceType') {
                    if (!form.querySelector(`input[name="serviceType"]:checked`)) {
                        fieldInvalid = true;
                         if (serviceOptionsContainer) {
                              serviceOptionsContainer.style.border = '2px solid #FF5459';
                              serviceOptionsContainer.style.borderRadius = 'var(--radius)';
                              serviceOptionsContainer.style.padding = '5px';
                         }
                    }
                } else if (field.tagName === 'SELECT' && field.value === '') { // Check select specifically
                     fieldInvalid = true;
                     field.style.borderColor = '#FF5459';
                 }
                 else if (field.tagName !== 'SELECT' && (!field.value || field.value.trim() === '')) { // Check other inputs
                    fieldInvalid = true;
                    field.style.borderColor = '#FF5459';
                } else {
                    field.style.borderColor = '';
                }

                if(fieldInvalid){
                     isValid = false;
                     if (!firstErrorField) firstErrorField = field;
                }
            });

            const phoneInput = form.querySelector('#phone');
            if (phoneInput && phoneInput.value.trim() && phoneInput.style.borderColor !== 'rgb(255, 84, 89)') {
                // Phone format validation slightly relaxed to allow partial input during typing
                if (phoneInput.value.length > 0 && !/^\(\d{0,3}\)?[ ]?\d{0,3}[-]?\d{0,4}$/.test(phoneInput.value)) {
                     // Final check only if not empty and not already marked invalid
                     if (!/^\(\d{3}\) \d{3}-\d{4}$/.test(phoneInput.value)) {
                         phoneInput.style.borderColor = '#FF5459'; isValid = false; if (!firstErrorField) firstErrorField = phoneInput;
                     }
                 } else if (phoneInput.value.length > 0 && !/^\(\d{3}\) \d{3}-\d{4}$/.test(phoneInput.value)) {
                     phoneInput.style.borderColor = '#FF5459'; isValid = false; if (!firstErrorField) firstErrorField = phoneInput;
                 }
            }
            const emailInput = form.querySelector('#email');
            if (emailInput && emailInput.value.trim() && emailInput.style.borderColor !== 'rgb(255, 84, 89)') {
                if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(emailInput.value)) {
                    emailInput.style.borderColor = '#FF5459'; isValid = false; if (!firstErrorField) firstErrorField = emailInput;
                }
            }

            if (!isValid) {
                alert('Please fill in all required fields correctly.');
                if (firstErrorField) {
                     // Ensure the 'Book Now' tab is active before focusing
                     const bookTabButton = document.querySelector('.tab-button[data-target="book-pane"]');
                     if(bookTabButton && !bookTabButton.classList.contains('active')) {
                         bookTabButton.click();
                         // Need a slight delay to allow tab switch before focus/scroll
                         setTimeout(() => {
                             firstErrorField.focus();
                             firstErrorField.scrollIntoView({ behavior: 'smooth', block: 'center' });
                         }, 100);
                     } else {
                         firstErrorField.focus();
                         firstErrorField.scrollIntoView({ behavior: 'smooth', block: 'center' });
                     }
                }
            }
            return isValid;
        }

        function initializeSmoothScrolling() {
           console.log("Smooth scrolling initialization simplified due to tabs.");
        }
        function initializeAIRecommendation() {
            const btn = document.getElementById('getAiRecommendationBtn');
            const resultDiv = document.getElementById('aiRecommendation');
            const bookPane = document.getElementById('book-pane');
            if (!bookPane) return;

            const yearInput = bookPane.querySelector('#vehicleYear');
            const makeInput = bookPane.querySelector('#vehicleMake'); // Now a select
            const modelInput = bookPane.querySelector('#vehicleModel'); // Now a select
            const issueInput = bookPane.querySelector('#issueDescription');
            const radioLabels = bookPane.querySelectorAll('.service-option-label');

            if (!btn || !resultDiv || !yearInput || !makeInput || !modelInput || !issueInput) { console.warn("AI Recommendation elements not found within book-pane."); return; }

            btn.addEventListener('click', async () => {
                const year = yearInput.value; const make = makeInput.value; const model = modelInput.value; const issue = issueInput.value.trim();
                // Updated validation for select dropdowns
                if (!year || !make || !model) { resultDiv.textContent = 'Please provide vehicle Year, Make, and Model first.'; resultDiv.className = 'error'; resultDiv.style.display = 'block'; return; }
                const prompt = `You are an assistant for FultonTech7 mobile auto technician...\nVehicle: ${year} ${make} ${model}\nIssue: ${issue || 'Routine maintenance.'}\nServices:\n1. Basic ($250): Plugs, air filter, inspection.\n2. Comprehensive ($350): Full service (filters, fluids, diagnostics, plugs).\n3. Premium ($450): Comprehensive + fuel/throttle body cleaning etc.\nRecommend the best service (Basic Tune-Up, Comprehensive Tune-Up, or Premium Tune-Up) and give a 1-sentence explanation. Example: Comprehensive Tune-Up: Covers routine maintenance and diagnostics.`;
                btn.disabled = true; btn.innerHTML = '✨ Thinking... <span class="spinner"></span>'; resultDiv.textContent = ''; resultDiv.className = ''; resultDiv.style.display = 'none'; radioLabels.forEach(l => l.classList.remove('recommended'));
                try {
                    const { text: recommendationText } = await callGeminiApi(prompt, false); // No search
                    resultDiv.textContent = `AI Suggestion: ${recommendationText}`;
                    resultDiv.style.display = 'block';
                    let recommendedRadioId = null;
                    const lowerText = recommendationText.toLowerCase();
                    if (lowerText.includes('basic tune-up')) recommendedRadioId = 'basic';
                    else if (lowerText.includes('comprehensive tune-up')) recommendedRadioId = 'comprehensive';
                    else if (lowerText.includes('premium tune-up')) recommendedRadioId = 'premium';
                    if (recommendedRadioId) {
                        const radio = bookPane.querySelector(`#${recommendedRadioId}`);
                        const label = radio?.nextElementSibling;
                        if (label) { label.classList.add('recommended'); label.scrollIntoView({ behavior: 'smooth', block: 'nearest' }); }
                    }
                } catch (error) { console.error("Error getting AI recommendation:", error); resultDiv.textContent = `Sorry, recommendation failed: ${error.message}`; resultDiv.className = 'error'; resultDiv.style.display = 'block';
                } finally { btn.disabled = false; btn.innerHTML = '✨ Help Me Choose a Service'; }
            });
        }
        document.addEventListener('DOMContentLoaded', () => { // General listeners moved inside DOMContentLoaded
            document.querySelectorAll('.service-card').forEach(card => {
                card.addEventListener('mouseenter', () => card.classList.add('service-card--hover'));
                card.addEventListener('mouseleave', () => card.classList.remove('service-card--hover'));
            });
             const bookPane = document.getElementById('book-pane');
             if(bookPane) {
                 bookPane.querySelectorAll('input[name="serviceType"]').forEach(radio => {
                     const label = radio.nextElementSibling; if (!label) return;
                     radio.addEventListener('focus', () => label.style.boxShadow = '0 0 0 3px rgba(122, 139, 153, 0.3)');
                     radio.addEventListener('blur', () => label.style.boxShadow = '');
                 });
             }
        });
    </script>
</body>
</html>

