<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AUTOTECH7 - Mobile Technician | Fulton County, GA</title>
    <meta name="description" content="Professional mobile automotive technician serving Fulton County, GA. Transparent pricing, same-week appointments. Basic $250, C                    <img src="https://us.chat-img.sintra.ai/807c1317-1ece-4cd6-b4d7-bbc4fd5ac33e/be835d69-6252-4727-b6c7-009f38580d31/Photoroom_20251022_203721.png" alt="AUTOTECH7 Logo" class="logo"
                       onerror="this.onerror=null; this.src='https://placehold.co/150x50/A0B2C1/FFFFFF?text=FT7';">

    <!-- Schema.org LocalBusiness structured data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "LocalBusiness",
      "name": "AUTOTECH7",
      "description": "Professional mobile automotive technician serving Fulton County, GA",
      "telephone": "+17739999783", /* Updated Phone */
      "email": "admin@at7.it.com", /* Added Email */
      "areaServed": ["South Fulton", "Union City", "Fairburn", "Palmetto"],
      "serviceType": "Mobile Automotive Technician",
      "priceRange": "$250-$450",
      "address": {
        "@type": "PostalAddress",
        "addressLocality": "Fulton County",
        "addressRegion": "GA",
        "addressCountry": "US"
      }
    }
    </script>

    <style>
        /* Reset and base styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
            font-size: 16px;
        }

        body {
            font-family: 'Inter', 'Roboto', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            line-height: 1.6;
            color: #2D3748; /* Darker text for light bg */
            /* Light Liquid Glassmorphism Background */
            background: linear-gradient(135deg, #E0E8FF, #F0F4F8, #D8D8D8, #F0F4F8);
            background-size: 400% 400%;
            animation: liquidGradient 20s ease infinite; /* Slower animation */
            min-height: 100vh;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        @keyframes liquidGradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }


        /* Custom properties - Adjusted for Light Glassmorphism */
        :root {
            --primary-color: #4A5568; /* Darker Gray-Blue Primary */
            --accent-color: #2D3748; /* Dark Gray Accent */
            --background-light: rgba(255, 255, 255, 0.2); /* Transparent white */
            --background-white: rgba(255, 255, 255, 0.4); /* More opaque white */
            --text-primary: #1A202C; /* Very Dark Gray Text */
            --text-muted: #718096; /* Medium Gray Muted Text */
            --border-color: rgba(0, 0, 0, 0.1); /* Subtle dark border */
            --shadow: 0 4px 10px rgba(0, 0, 0, 0.05); /* Softer shadow */
            --shadow-lg: 0 10px 25px rgba(0, 0, 0, 0.08);
            --radius: 10px;
            --radius-lg: 16px;
            --container-width: 1200px;
            --container-medium-width: 800px;
            --section-padding: 4rem 0;
            --accent-color-rgb: 45, 55, 72; /* Dark Gray */
            --primary-color-rgb: 74, 85, 104; /* Darker Gray-Blue */
            --header-height: 80px;
            --blur-amount-light: 6px; /* Slightly less blur */
            --blur-amount-medium: 10px;
            --blur-amount-heavy: 14px;
            --hero-text-primary: #F0F0F0; /* Brighter primary text FOR HERO */
            --hero-accent-color: #FFFFFF; /* White accent FOR HERO */
        }

        /* Typography */
        h1, h2, h3, h4, h5, h6 {
            font-weight: 600;
            line-height: 1.2;
            margin-bottom: 0.5em;
            color: var(--text-primary); /* Use primary text color */
            text-align: center; /* Center all headings */
        }

        h1 { font-size: 2.5rem; }
        h2 { font-size: 2rem; }
        h3 { font-size: 1.5rem; }
        h4 { font-size: 1.25rem; }
        h5 { font-size: 1.125rem; }
        h6 { font-size: 1rem; }

        p {
            margin-bottom: 1em;
            color: var(--text-muted);
        }
        .service-description, .form-subtitle, .section-subtitle, .footer-text {
            color: var(--text-muted);
            text-align: center;
        }
        /* Hero Paragraph handled specifically below */


        a {
            color: var(--primary-color);
            text-decoration: none;
            transition: color 0.3s ease;
        }
        a:hover {
             color: var(--accent-color);
        }

        /* Container */
        .container { max-width: var(--container-width); margin: 0 auto; padding: 0 1rem; }
        .container--medium { max-width: var(--container-medium-width); }


        /* Header - Light Glassmorphism */
        .header {
            position: sticky; top: 0; z-index: 1000;
            background: rgba(255, 255, 255, 0.3); /* Lighter transparent bg */
            backdrop-filter: blur(var(--blur-amount-medium));
            -webkit-backdrop-filter: blur(var(--blur-amount-medium));
            border-bottom: 1px solid rgba(0, 0, 0, 0.08); /* More subtle border */
            box-shadow: none;
        }

        .header__content {
            display: flex; align-items: center; justify-content: space-between;
            padding: 0 1rem; min-height: var(--header-height); position: relative;
            z-index: 1001; background: none; max-width: var(--container-width); margin: 0 auto;
        }

        .header__logo { display: flex; align-items: center; gap: 0.75rem; cursor: pointer; flex-shrink: 0; }
        .logo { width: 48px; height: 48px; object-fit: contain; }
        .header__title {
            font-size: 1.5rem; font-weight: 700; color: var(--accent-color); /* Keep title dark */
            margin-bottom: 0; white-space: nowrap; text-align: left;
        }

        /* --- Desktop Header Navigation (Integrated) --- */
        .header-nav-desktop { display: none; align-items: center; gap: 0.5rem; margin-left: auto; }
        @media (min-width: 901px) { .header-nav-desktop { display: flex; } }
        .header-nav-desktop .tab-button {
            padding: 0.5rem 1rem; border: none; background: transparent; font-size: 0.95rem;
            font-weight: 500; color: var(--text-muted); cursor: pointer; border-radius: var(--radius-sm);
            transition: all 0.2s ease; white-space: nowrap; border-bottom: none; text-align: center;
        }
        .header-nav-desktop .tab-button:hover {
            color: var(--accent-color); background-color: rgba(0, 0, 0, 0.05); /* Subtle dark hover */
        }
        .header-nav-desktop .tab-button.active {
            color: var(--accent-color); font-weight: 600; background-color: rgba(0, 0, 0, 0.08); /* Slightly stronger dark active */
             border-bottom: none;
        }


        /* --- Mobile Menu Toggle --- */
        .mobile-menu-toggle { display: none; cursor: pointer; padding: 0.5rem; border: none; background: none; z-index: 1002; margin-left: 1rem; }
        .hamburger-icon { display: block; width: 24px; height: 2px; background-color: var(--text-primary); position: relative; transition: background-color 0.3s ease; }
        .hamburger-icon::before, .hamburger-icon::after { content: ''; display: block; width: 24px; height: 2px; background-color: var(--text-primary); position: absolute; left: 0; transition: transform 0.3s ease; }
        .hamburger-icon::before { top: -7px; } .hamburger-icon::after { top: 7px; }
        .mobile-menu-toggle.open .hamburger-icon { background-color: transparent; }
        .mobile-menu-toggle.open .hamburger-icon::before { transform: translateY(7px) rotate(45deg); }
        .mobile-menu-toggle.open .hamburger-icon::after { transform: translateY(-7px) rotate(-45deg); }

        /* --- Mobile Menu Container (Light Glassmorphism) --- */
        .mobile-menu {
            display: none; position: absolute; top: 100%; left: 0; right: 0;
            background: rgba(255, 255, 255, 0.6); /* Lighter, more opaque */
            backdrop-filter: blur(var(--blur-amount-heavy)); -webkit-backdrop-filter: blur(var(--blur-amount-heavy));
            border-top: 1px solid var(--border-color); box-shadow: var(--shadow-lg);
            z-index: 1000; padding: 1rem 0; max-height: calc(100vh - var(--header-height)); overflow-y: auto;
        }
        .header.mobile-menu-active .mobile-menu { display: block; animation: slideDown 0.3s ease-out; }
        .mobile-menu-nav { display: flex; flex-direction: column; gap: 0; }
        .mobile-menu .tab-button {
            display: block; width: 100%; padding: 1rem 1.5rem; border-bottom: 1px solid var(--border-color);
            border-radius: 0; text-align: left; color: var(--text-primary); background: transparent;
            font-weight: 500; border-bottom-color: var(--border-color);
        }
        .mobile-menu .tab-button:last-child { border-bottom: none; }
        .mobile-menu .tab-button.active {
            background-color: rgba(var(--primary-color-rgb), 0.1); /* Subtle active bg */
            color: var(--accent-color); font-weight: 600;
        }

        /* --- Media Query for Showing/Hiding Elements --- */
        @media (max-width: 900px) { .mobile-menu-toggle { display: block; } .header-nav-desktop { display: none; } }
        @media (min-width: 901px) { .mobile-menu-toggle { display: none; } .mobile-menu { display: none !important; } .header.mobile-menu-active .mobile-menu { display: none !important; } }
        @keyframes slideDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }

        /* --- Tab Content Area --- */
        .tab-content { padding-top: 2rem; }
        .tab-pane { display: none; }
        .tab-pane.active { display: block; animation: fadeIn 0.5s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Buttons - Adjusted for Light Theme */
        .btn { display: inline-flex; align-items: center; justify-content: center; padding: 0.75rem 1.5rem; border: 1px solid transparent; border-radius: var(--radius); font-weight: 600; text-decoration: none; cursor: pointer; transition: all 0.3s ease; min-height: 44px; font-size: 1rem; line-height: 1; }
        .btn--primary { background: var(--primary-color); color: var(--background-white); border-color: var(--primary-color); }
        .btn--primary:hover { background: var(--accent-color); color: #FFF; border-color: var(--accent-color); transform: translateY(-2px); }
        .btn--secondary { background: rgba(var(--primary-color-rgb), 0.1); color: var(--primary-color); border: 1px solid var(--primary-color); backdrop-filter: blur(var(--blur-amount-light)); -webkit-backdrop-filter: blur(var(--blur-amount-light)); }
        .btn--secondary:hover { background: rgba(var(--primary-color-rgb), 0.2); border-color: var(--accent-color); color: var(--accent-color); }
        .btn--quick-option { background: rgba(var(--primary-color-rgb), 0.08); color: var(--primary-color); border: 1px solid rgba(var(--primary-color-rgb), 0.2); padding: 0.5rem 1rem; font-size: 0.875rem; min-height: auto; font-weight: 500; border-radius: var(--radius-sm); backdrop-filter: blur(var(--blur-amount-light)); -webkit-backdrop-filter: blur(var(--blur-amount-light)); }
        .btn--quick-option:hover { background: rgba(var(--primary-color-rgb), 0.15); border-color: rgba(var(--primary-color-rgb), 0.3); transform: translateY(-1px); color: var(--accent-color); }
        .btn--full { width: 100%; }

        /* Hero Section Styles - Updated */
        .hero { position: relative; text-align: center; color: var(--text-primary); min-height: 60vh; display: flex; align-items: center; justify-content: center; overflow: hidden; }
        .hero img.hero-background { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; z-index: -1; filter: brightness(0.9) contrast(0.9); }
        /* --- Hero Content Styles START --- */
        .hero-content {
            background: rgba(26, 35, 50, 0.7); backdrop-filter: blur(var(--blur-amount-medium)); -webkit-backdrop-filter: blur(var(--blur-amount-medium));
            border: 1px solid rgba(255, 255, 255, 0.1); padding: 2rem; border-radius: var(--radius-lg); max-width: 600px; margin: 1rem; z-index: 1; box-shadow: var(--shadow-lg);
        }
        .hero-content h1 { font-size: 2.75rem; font-weight: 700; color: var(--hero-accent-color); margin-bottom: 0.75rem; text-shadow: none; }
        .hero-content p { font-size: 1.2rem; color: var(--hero-text-primary); margin-bottom: 1.5rem; text-align: center; text-shadow: none; }
        .pricing { display: flex; justify-content: center; gap: 1.5rem; margin-bottom: 2rem; font-weight: 500; color: var(--hero-text-primary); flex-wrap: wrap; text-shadow: none; }
        .pricing span { background: rgba(255, 255, 255, 0.1); padding: 0.3rem 0.8rem; border-radius: var(--radius-sm); color: var(--hero-text-primary); border: 1px solid rgba(255, 255, 255, 0.15); }
        .cta-button { display: inline-flex; align-items: center; justify-content: center; padding: 0.85rem 2rem; border-radius: var(--radius); font-weight: 600; text-decoration: none; cursor: pointer; transition: all 0.3s ease; min-height: 48px; font-size: 1.1rem; line-height: 1; background: var(--primary-color); color: var(--background-white); border: none; }
        .cta-button:hover { background: #2D3748; transform: translateY(-2px); color: #FFF; }
        /* --- Hero Content Styles END --- */
        @media (max-width: 768px) { .hero { min-height: 50vh; } .hero-content h1 { font-size: 2.25rem; } .hero-content p { font-size: 1.1rem; } .pricing { gap: 1rem; font-size: 0.9rem; } .cta-button { padding: 0.75rem 1.5rem; font-size: 1rem; } }
        @media (max-width: 480px) { .hero-content h1 { font-size: 1.875rem; } .hero-content p { font-size: 1rem; } .pricing span { padding: 0.2rem 0.6rem; } }

        /* Services & Pricing */
        .services { padding: var(--section-padding); background: transparent; }
        .section-header { text-align: center; margin-bottom: 3rem; }
        .section-title { color: var(--accent-color); margin-bottom: 1rem; text-align: center; }
        .section-subtitle { font-size: 1.125rem; color: var(--text-muted); text-align: center; }
        .services-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem; margin-top: 3rem; }
        .service-card { background: var(--background-white); backdrop-filter: blur(var(--blur-amount-medium)); -webkit-backdrop-filter: blur(var(--blur-amount-medium)); border: 1px solid var(--border-color); padding: 2rem; border-radius: var(--radius-lg); text-align: center; transition: all 0.3s ease; cursor: pointer; box-shadow: var(--shadow); }
        .service-card:hover { transform: translateY(-8px); border-color: rgba(0, 0, 0, 0.15); box-shadow: var(--shadow-lg); }
        .service-price { font-size: 3rem; font-weight: 700; color: var(--primary-color); margin-bottom: 1rem; text-align: center; }
        .service-name { font-size: 1.5rem; color: var(--accent-color); margin-bottom: 1rem; text-align: center; }
        .service-description { color: var(--text-muted); margin-bottom: 1.5rem; text-align: center; }

        /* Service Areas */
        .service-areas { padding: var(--section-padding); background: transparent; text-align: center; }
        .areas-grid { display: flex; justify-content: center; gap: 1rem; flex-wrap: wrap; margin-top: 2rem; }
        .area-badge { background: rgba(var(--primary-color-rgb), 0.1); color: var(--primary-color); border: 1px solid rgba(var(--primary-color-rgb), 0.2); backdrop-filter: blur(var(--blur-amount-light)); -webkit-backdrop-filter: blur(var(--blur-amount-light)); padding: 0.75rem 1.5rem; border-radius: var(--radius-lg); font-weight: 600; font-size: 1.125rem; cursor: pointer; transition: all 0.3s ease; box-shadow: var(--shadow); }
        .area-badge:hover { background: rgba(var(--accent-color-rgb), 0.1); color: var(--accent-color); border-color: rgba(var(--accent-color-rgb), 0.2); transform: translateY(-2px); }

        /* AI Common Options */
        .common-options { margin-top: 1rem; display: flex; flex-wrap: wrap; gap: 0.75rem; padding-top: 1rem; border-top: 1px dashed var(--border-color); justify-content: center; }
        .common-options-label { font-size: 0.875rem; color: var(--text-muted); margin-bottom: 0.5rem; display: block; width: 100%; text-align: center; }

        /* AI Sections & Form Containers */
        .ai-faq, .ai-diagnoser, .ai-parts-finder, .lead-capture { padding: var(--section-padding); background: transparent; }
        .ai-faq-container, .ai-diagnoser-container, .ai-parts-container, .form-container { background: var(--background-white); backdrop-filter: blur(var(--blur-amount-heavy)); -webkit-backdrop-filter: blur(var(--blur-amount-heavy)); border: 1px solid var(--border-color); padding: 2.5rem; border-radius: var(--radius-lg); box-shadow: var(--shadow); margin: 0 auto; }

        /* AI Specific Styles */
        .ai-faq-input-group { display: flex; gap: 1rem; align-items: stretch; }
        #aiQuestionInput { flex-grow: 1; }
        #askAiBtn { white-space: nowrap; }
        #aiAnswer, #aiDiagnosisAnswer, #aiPartsAnswer { margin-top: 1.5rem; padding: 1.5rem; background-color: rgba(255,255,255,0.15); border: 1px solid var(--border-color); border-radius: var(--radius); color: var(--text-primary); font-size: 0.95rem; min-height: 50px; line-height: 1.7; white-space: pre-wrap; text-align: left; }
        #aiDiagnosisAnswer ul { list-style-position: inside; margin-top: 1rem; padding-left: 0.5rem; text-align: left; }
        #aiDiagnosisAnswer li { margin-bottom: 0.5rem; text-align: left; }
        .ai-diagnoser-container .form-group:has(#getAiDiagnosisBtn) { text-align: center; } /* Center the button wrapper */
        #getAiDiagnosisBtn { width: auto; /* Allow button to size naturally */ display: inline-flex; /* Needed for centering with text-align */ }
        #bookDiagnosisBtn { margin-top: 1.5rem; width: 100%; display: none; }
        .parts-form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem 1.5rem; margin-bottom: 1.5rem; align-items: end; }
        #aiPartsAnswer strong { color: #c53030; }
        #aiPartsAnswer a { color: var(--primary-color); text-decoration: underline; } /* Style links */
        #aiPartsAnswer a:hover { color: var(--accent-color); }

        /* Common Loading/Error */
        #aiAnswer.loading, #aiPartsAnswer.loading, #aiDiagnosisAnswer.loading { color: var(--text-muted); display: flex; align-items: center; justify-content: center; font-style: italic; background-color: rgba(255,255,255,0.15); }
        #aiAnswer.error, #aiPartsAnswer.error, #aiDiagnosisAnswer.error { background-color: rgba(254, 226, 226, 0.5); border-color: rgba(248, 113, 113, 0.4); color: #9B2C2C; font-style: normal; text-align: left; }

        /* Lead Capture Form */
        .form-title { text-align: center; color: var(--accent-color); margin-bottom: 1rem; }
        .form-subtitle { text-align: center; color: var(--text-muted); margin-bottom: 2rem; }
        .form-group { margin-bottom: 1.5rem; }
        .form-label { display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-primary); text-align: left; }
        .form-control { width: 100%; padding: 0.75rem; border-radius: var(--radius); font-size: 1rem; transition: border-color 0.3s ease; min-height: 44px; appearance: none; background-color: rgba(255, 255, 255, 0.2); border: 1px solid var(--border-color); color: var(--text-primary); }
        .form-control::placeholder { color: var(--text-muted); opacity: 0.8; }
        select.form-control { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23718096' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E"); background-repeat: no-repeat; background-position: right 0.75rem center; background-size: 1em; padding-right: 2.5rem; }
        select.form-control:disabled { background-color: rgba(0,0,0,0.05); cursor: not-allowed; opacity: 0.7; }
        .form-control:focus { outline: none; border-color: var(--primary-color); box-shadow: 0 0 0 3px rgba(var(--primary-color-rgb), 0.2); background-color: rgba(255, 255, 255, 0.3); }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
        .service-options { display: grid; gap: 1rem; }
        .service-option { position: relative; }
        .service-option input[type="radio"] { position: absolute; opacity: 0; width: 0; height: 0; }
        .service-option-label { display: block; padding: 1rem; border-radius: var(--radius); cursor: pointer; transition: all 0.3s ease; background-color: rgba(255, 255, 255, 0.2); border: 1px solid var(--border-color); text-align: left; }
        .service-option-label.recommended { border-color: #D69E2E; background-color: rgba(251, 235, 188, 0.3); box-shadow: 0 0 0 3px rgba(214, 158, 46, 0.3); }
        .service-option input[type="radio"]:checked + .service-option-label { border-color: var(--primary-color); background: rgba(var(--primary-color-rgb), 0.15); }
        .service-option-label:hover { background: rgba(255, 255, 255, 0.3); }
        .service-option-title { font-weight: 600; color: var(--primary-color); margin-bottom: 0.25rem; text-align: left; }
        .service-option-desc { color: var(--text-muted); font-size: 0.875rem; text-align: left; }
        #aiRecommendation { margin-top: 1rem; padding: 1rem; background-color: rgba(239, 246, 255, 0.5); border: 1px solid rgba(147, 197, 253, 0.4); border-radius: var(--radius); color: #3B82F6; font-size: 0.9rem; display: none; text-align: left; }
        #aiRecommendation.error { background-color: rgba(254, 226, 226, 0.5); border-color: rgba(248, 113, 113, 0.4); color: #9B2C2C; }
        .form-actions { display: grid; gap: 1rem; margin-top: 2rem; }
        .calendly-link { text-align: center; padding: 0.75rem; border-radius: var(--radius); text-decoration: none; font-weight: 600; transition: all 0.3s ease; background: rgba(var(--primary-color-rgb), 0.08); color: var(--primary-color); border: 1px solid var(--primary-color); backdrop-filter: blur(var(--blur-amount-light)); -webkit-backdrop-filter: blur(var(--blur-amount-light)); }
        .calendly-link:hover { background: rgba(var(--primary-color-rgb), 0.15); border-color: var(--accent-color); color: var(--accent-color); }

        /* Info Section */
        .info-section { padding: var(--section-padding); background: transparent; }
        .info-grid-visual { display: grid; grid-template-columns: 1fr; gap: 2rem; margin-top: 3rem; }
        @media (min-width: 768px) { .info-grid-visual { grid-template-columns: 1fr 1fr; } }
        .info-visual-card { background: var(--background-white); backdrop-filter: blur(var(--blur-amount-medium)); -webkit-backdrop-filter: blur(var(--blur-amount-medium)); border: 1px solid var(--border-color); border-radius: var(--radius-lg); box-shadow: var(--shadow); overflow: hidden; display: flex; flex-direction: column; }
        .info-visual-card img { width: 100%; height: 280px; object-fit: cover; border-bottom: 1px solid var(--border-color); opacity: 0.95; }
        .info-visual-content { padding: 2rem; }
        .info-visual-content h3 { color: var(--accent-color); margin-bottom: 1.5rem; text-align: center; }
        .info-list { list-style: none; padding: 0; }
        .info-list li { padding: 0.75rem 0; padding-left: 2rem; position: relative; color: var(--text-primary); text-align: left; /* Keep list text left-aligned */ }
        .info-list li::before { content: '✓'; position: absolute; left: 0; top: 0.75rem; /* Adjusted alignment */ color: var(--primary-color); font-weight: 700; font-size: 1.25rem; line-height: 1.6; /* Match text line-height */ }

        /* Footer */
        .footer { background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(var(--blur-amount-light)); -webkit-backdrop-filter: blur(var(--blur-amount-light)); border-top: 1px solid var(--border-color); color: var(--text-primary); padding: 3rem 0 1rem 0; text-align: center; margin-top: auto; }
        .footer-content { display: flex; flex-direction: column; align-items: center; gap: 1.5rem; margin-bottom: 2rem; }
        .footer-links { display: flex; gap: 1.5rem; flex-wrap: wrap; justify-content: center; }
        .footer-links a { color: var(--text-muted); text-decoration: none; font-weight: 500; transition: color 0.3s ease; }
        .footer-links a:hover { color: var(--accent-color); }
        .footer-text { color: var(--text-muted); margin-bottom: 0; text-align: center; }
        .footer-copyright { color: rgba(var(--accent-color-rgb), 0.7); font-size: 0.875rem; margin-top: 1rem; text-align: center; }


        /* Honeypot field */
        .honeypot { position: absolute; left: -5000px; }

        /* Mobile Responsiveness */
        @media (max-width: 900px) {
             .ai-faq-container, .ai-diagnoser-container, .form-container, .ai-parts-container { padding: 1.5rem; }
             .ai-faq-input-group { flex-direction: column; align-items: stretch; }
             .form-row { grid-template-columns: 1fr; }
             .parts-form-grid { grid-template-columns: 1fr; }
             .container { padding: 0 0.75rem; }
             h1 { font-size: 2rem; } h2 { font-size: 1.75rem; } h3 { font-size: 1.5rem; }
             .footer-links { flex-direction: column; gap: 1rem; }
             .info-list li { text-align: left; }
             .info-list li::before { left: 0; }
        }
        @media (max-width: 480px) {
            .service-price { font-size: 2.5rem; }
            .btn { padding: 0.875rem 1rem; font-size: 0.9rem; }
            .common-options { justify-content: center; }
            .common-options-label { text-align: center; }
        }

        /* Focus styles */
        .btn:focus, .cta-button:focus, .form-control:focus, .nav-link:focus, .tab-button:focus, .footer-links a:focus { outline: 2px solid var(--primary-color); outline-offset: 2px; border-radius: 2px; }

        /* Loading states */
        .btn:disabled, .cta-button:disabled { opacity: 0.6; cursor: not-allowed; }

        /* Spinner */
        .spinner { display: inline-block; width: 1em; height: 1em; border: 2px solid currentColor; border-right-color: transparent; border-radius: 50%; animation: spinner-border .75s linear infinite; vertical-align: text-bottom; margin-left: 0.5em; }
        @keyframes spinner-border { to { transform: rotate(360deg); } }

        /* Full height layout */
        html, body { height: 100%; }
        body { display: flex; flex-direction: column; }
        main { flex: 1 0 auto; }

    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <!-- Header Content (Logo, Title, Toggle) -->
            <div class="header__content">
                <div class="header__logo" id="logoLink">
                    <img src="https://us.chat-img.sintra.ai/807c1317-1ece-4cd6-b4d7-bbc4fd5ac33e/be835d69-6252-4727-b6c7-009f38580d31/Photoroom_20251022_203721.png" alt="AUTOTECH7 Logo" class="logo"
                     onerror="this.onerror=null; this.src='https://placehold.co/48x48/4A5568/FFFFFF?text=F7';">
                    <div class="header__title">AUTOTECH7</div>
                </div>

                <!-- Desktop Navigation (Integrated) -->
                <nav class="header-nav-desktop">
                    <button class="tab-button active" data-target="home-pane">Home</button>
                    <button class="tab-button" data-target="diagnoser-pane">AI Diagnoser</button>
                    <button class="tab-button" data-target="faq-pane">AI Assistant</button>
                    <button class="tab-button" data-target="parts-pane">Parts Finder</button>
                    <button class="tab-button" data-target="book-pane">Book Now</button>
                </nav>

                <!-- Mobile Menu Toggle -->
                <button class="mobile-menu-toggle" aria-label="Toggle menu" aria-expanded="false">
                    <span class="hamburger-icon"></span>
                </button>
            </div>

            <!-- Mobile Menu Dropdown -->
            <nav class="mobile-menu">
                <div class="mobile-menu-nav">
                    <button class="tab-button active" data-target="home-pane">Home</button>
                    <button class="tab-button" data-target="diagnoser-pane">AI Diagnoser</button>
                    <button class="tab-button" data-target="faq-pane">AI Assistant</button>
                    <button class="tab-button" data-target="parts-pane">Parts Finder</button>
                    <button class="tab-button" data-target="book-pane">Book Now</button>
                </div>
            </nav>
        </div>
    </header>

    <!-- Main Content Area -->
    <main class="tab-content">

        <!-- Home Pane -->
        <div id="home-pane" class="tab-pane active">
            <!-- Hero Section -->
            <section class="hero">
              <img src="https://us.chat-img.sintra.ai/807c1317-1ece-4cd6-b4d7-bbc4fd5ac33e/0c26277b-6102-46d1-844c-a4c7a3bc95ad/image.png?w=1024&h=1024" alt="AUTOTECH7 Mobile Technician working under car hood" class="hero-background"
                onerror="this.onerror=null; this.src='https://placehold.co/1200x800/A0B2C1/FFFFFF?text=AUTOTECH7+Mobile+Service';">

              <div class="hero-content">
                <h1>Professional Tune-Ups at Your Driveway</h1>
                <p>Licensed & insured mobile technician serving Fulton County</p>

                <div class="pricing">
                  <span>Basic: $250</span>
                  <span>Comprehensive: $350</span>
                  <span>Premium: $450</span>
                </div>
                <a href="https://calendly.com/autotech7/30min?month=2025-10" class="cta-button" target="_blank" rel="noopener noreferrer">
                  Book Same-Week Appointment
                </a>
              </div>
            </section>

            <!-- Services & Pricing Section -->
            <section id="services" class="services">
                <div class="container">
                    <div class="section-header">
                        <h2 class="section-title">Our Services</h2>
                        <p class="section-subtitle">Professional automotive tune-up services with transparent, up-front pricing</p>
                    </div>

                    <div class="services-grid">
                        <div class="service-card clickable-service-card tab-switcher" data-target-tab="book" data-service="basic">
                            <div class="service-price">$250</div>
                            <h3 class="service-name">Basic Tune-Up</h3>
                            <p class="service-description">Spark plugs, air filter, basic inspection</p>
                        </div>
                        <div class="service-card clickable-service-card tab-switcher" data-target-tab="book" data-service="comprehensive">
                            <div class="service-price">$350</div>
                            <h3 class="service-name">Comprehensive Tune-Up</h3>
                            <p class="service-description">Full service including filters, fluids, diagnostics</p>
                        </div>
                        <div class="service-card clickable-service-card tab-switcher" data-target-tab="book" data-service="premium">
                            <div class="service-price">$450</div>
                            <h3 class="service-name">Premium Tune-Up</h3>
                            <p class="service-description">Complete service with additional maintenance items</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Service Areas Section -->
            <section class="service-areas">
                <div class="container">
                    <div class="section-header">
                        <h2 class="section-title">Areas We Serve</h2>
                        <p class="section-subtitle">Professional mobile service throughout Fulton County</p>
                    </div>

                    <div class="areas-grid">
                        <div class="area-badge clickable-area-badge tab-switcher" data-target-tab="book" data-area="South Fulton">South Fulton</div>
                        <div class="area-badge clickable-area-badge tab-switcher" data-target-tab="book" data-area="Union City">Union City</div>
                        <div class="area-badge clickable-area-badge tab-switcher" data-target-tab="book" data-area="Fairburn">Fairburn</div>
                        <div class="area-badge clickable-area-badge tab-switcher" data-target-tab="book" data-area="Palmetto">Palmetto</div>
                    </div>
                </div>
            </section>

             <!-- Info Section -->
            <section class="info-section">
                <div class="container">
                    <div class="section-header">
                        <h2 class="section-title">Professional Service You Can Trust</h2>
                        <p class="section-subtitle">Expertise and convenience, delivered to your driveway.</p>
                    </div>

                    <div class="info-grid-visual">
                        <div class="info-visual-card">
                            <img src="https://us.chat-img.sintra.ai/807c1317-1ece-4cd6-b4d7-bbc4fd5ac33e/f7cb149a-d0eb-49a5-b2ef-459277d451ec/image.png?w=1024&h=1024" alt="Professional diagnostic tools and equipment"
                             onerror="this.onerror=null; this.src='https://placehold.co/600x400/1A202C/FFFFFF?text=Quality+Tools';">
                            <div class="info-visual-content">
                                <h3>Why Choose Us</h3>
                                <ul class="info-list">
                                    <li>Transparent, up-front pricing</li>
                                    <li>Mobile service — we come to you</li>
                                    <li>Licensed &amp; insured</li>
                                    <li>Same-week availability</li>
                                </ul>
                            </div>
                        </div>

                        <div class="info-visual-card">
                            <img src="https://us.chat-img.sintra.ai/807c1317-1ece-4cd6-b4d7-bbc4fd5ac33e/2d35cf6a-5e4f-4d3e-8039-61d3aec3bb49/image.png?w=1024&h=1024" alt="Happy customer receiving convenient mobile service"
                             onerror="this.onerror=null; this.src='https://placehold.co/600x400/4A5568/FFFFFF?text=Happy+Customer';">
                            <div class="info-visual-content">
                                <h3>What to Expect</h3>
                                <ul class="info-list">
                                    <li>Quick confirmation after you submit</li>
                                    <li>Friendly reminders before the visit</li>
                                    <li>Professional service at your driveway</li>
                                    <li>Simple payment on completion</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div> <!-- End Home Pane -->

        <!-- AI Diagnoser Pane -->
        <div id="diagnoser-pane" class="tab-pane">
            <section id="ai-diagnoser" class="ai-diagnoser">
                 <div class="container container--medium">
                     <div class="section-header">
                         <h2 class="section-title">What's Wrong With My Car?</h2>
                         <p class="section-subtitle">Describe your car's symptoms or select common issues below.</p>
                     </div>
                     <div class="ai-diagnoser-container">
                         <div class="form-group">
                             <label for="vehicleInfoInput" class="form-label">Vehicle (Optional, but helpful)</label>
                             <input type="text" id="vehicleInfoInput" class="form-control" placeholder="e.g., 2018 Toyota Camry">
                         </div>
                         <div class="form-group">
                             <label for="symptomsInput" class="form-label">Describe Symptoms *</label>
                             <textarea id="symptomsInput" class="form-control" rows="4" placeholder="e.g., Car makes a loud rattling noise when I accelerate..." required></textarea>
                             <div class="common-options">
                                <span class="common-options-label">Or, select common issues:</span>
                                <button type="button" class="btn btn--quick-option symptom-button">Check Engine Light On</button>
                                <button type="button" class="btn btn--quick-option symptom-button">Strange Noise (Rattling)</button>
                                <button type="button" class="btn btn--quick-option symptom-button">Strange Noise (Grinding)</button>
                                <button type="button" class="btn btn--quick-option symptom-button">Won't Start</button>
                                <button type="button" class="btn btn--quick-option symptom-button">Overheating</button>
                                <button type="button" class="btn btn--quick-option symptom-button">Brake Issues</button>
                                <button type="button" class="btn btn--quick-option symptom-button">Fluid Leak</button>
                                <button type="button" class="btn btn--quick-option symptom-button">Smells Like Gas</button>
                             </div>
                         </div>
                         <!-- Centered Button -->
                         <div class="form-group" style="text-align: center;">
                             <button type="button" id="getAiDiagnosisBtn" class="btn btn--primary">✨ Get AI Diagnosis</button>
                         </div>
                         <div class="form-group">
                             <div id="aiDiagnosisAnswer" style="display: none;"></div>
                             <button type="button" id="bookDiagnosisBtn" class="btn btn--secondary btn--full-width tab-switcher" data-target-tab="book">Book a Diagnostic Service</button>
                         </div>
                     </div>
                </div>
            </section>
        </div> <!-- End AI Diagnoser Pane -->

        <!-- AI FAQ Pane -->
        <div id="faq-pane" class="tab-pane">
            <section id="ai-faq" class="ai-faq">
                <div class="container container--medium">
                     <div class="section-header">
                         <h2 class="section-title">Have Questions? Ask Our AI Assistant!</h2>
                         <p class="section-subtitle">Get quick answers or select a common question below.</p>
                     </div>
                     <div class="ai-faq-container">
                         <div class="form-group">
                             <label for="aiQuestionInput" class="form-label">Your Question:</label>
                             <div class="ai-faq-input-group">
                                 <input type="text" id="aiQuestionInput" class="form-control" placeholder="e.g., What's included in the Basic Tune-Up?">
                                 <button type="button" id="askAiBtn" class="btn btn--primary">✨ Ask</button>
                             </div>
                             <div class="common-options">
                                <span class="common-options-label">Or, select a common question:</span>
                                <button type="button" class="btn btn--quick-option faq-button">What services do you offer?</button>
                                <button type="button" class="btn btn--quick-option faq-button">What areas do you serve?</button>
                                <button type="button" class="btn btn--quick-option faq-button">How much is a Basic Tune-Up?</button>
                                <button type="button" class="btn btn--quick-option faq-button">How much is a Comprehensive Tune-Up?</button>
                                <button type="button" class="btn btn--quick-option faq-button">Are you licensed and insured?</button>
                                <button type="button" class="btn btn--quick-option faq-button">Do you work on weekends?</button>
                             </div>
                         </div>
                         <div class="form-group">
                             <label class="form-label">AI Answer:</label>
                             <div id="aiAnswer">Ask a question or click a button above to get an answer from our AI assistant.</div>
                         </div>
                     </div>
                </div>
            </section>
        </div> <!-- End AI FAQ Pane -->

         <!-- AI Parts Finder Pane -->
        <div id="parts-pane" class="tab-pane">
            <section class="ai-parts-finder">
                <div class="container container--medium">
                    <div class="section-header">
                        <h2 class="section-title">AI Parts & Fluids Finder</h2>
                        <p class="section-subtitle">Get general guidance on parts or fluids for your vehicle.</p>
                    </div>
                    <div class="ai-parts-container">
                        <div class="parts-form-grid">
                            <div class="form-group">
                                <label class="form-label" for="partsVehicleYear">Vehicle Year *</label>
                                <select id="partsVehicleYear" class="form-control" required>
                                    <option value="">Select Year</option>
                                    <!-- Options populated by JS -->
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="partsVehicleMake">Vehicle Make *</label>
                                 <select id="partsVehicleMake" class="form-control" required>
                                     <option value="">Select Make</option>
                                     <!-- Options populated by JS -->
                                 </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="partsVehicleModel">Vehicle Model *</label>
                                 <select id="partsVehicleModel" class="form-control" required disabled>
                                     <option value="">Select Make First</option>
                                     <!-- Options populated by JS -->
                                 </select>
                            </div>
                             <div class="form-group">
                                 <label class="form-label" for="partsType">Part/Fluid Type *</label>
                                 <select id="partsType" class="form-control" required>
                                     <option value="">Select Type</option>
                                     <option value="Engine Oil">Engine Oil</option>
                                     <option value="Oil Filter">Oil Filter</option>
                                     <option value="Engine Air Filter">Engine Air Filter</option>
                                     <option value="Cabin Air Filter">Cabin Air Filter</option>
                                     <option value="Spark Plugs">Spark Plugs</option>
                                     <option value="Brake Fluid">Brake Fluid</option>
                                     <option value="Coolant/Antifreeze">Coolant/Antifreeze</option>
                                     <option value="Wiper Blades">Wiper Blades</option>
                                     <option value="Battery">Battery</option>
                                     <!-- Add more common items as needed -->
                                 </select>
                            </div>
                            <div class="form-group" style="grid-column: 1 / -1;"> <!-- Button spans full width potentially -->
                                <button type="button" id="findPartsBtn" class="btn btn--primary btn--full">✨ Find Info</button>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">AI Guidance:</label>
                            <div id="aiPartsAnswer">Select your vehicle and the part/fluid type above.</div>
                        </div>
                    </div>
                </div>
            </section>
        </div> <!-- End AI Parts Finder Pane -->

        <!-- Booking Pane -->
        <div id="book-pane" class="tab-pane">
             <section id="book-appointment" class="lead-capture">
                 <div class="container container--medium">
                    <div class="form-container">
                        <h2 class="form-title">Book Your Appointment</h2>
                        <p class="form-subtitle">We respond to all requests within 2 hours during business hours</p>

                        <form id="appointmentForm" name="appointment" method="POST" data-netlify="true" netlify-honeypot="bot-field">
                            <div class="honeypot"><label>Don't fill this out: <input name="bot-field"></label></div>
                            <input type="hidden" name="form-name" value="appointment">

                            <div class="form-row">
                                <div class="form-group"><label class="form-label" for="customerName">Customer Name *</label><input type="text" id="customerName" name="customerName" class="form-control" required></div>
                                <div class="form-group"><label class="form-label" for="phone">Phone Number *</label><input type="tel" id="phone" name="phone" class="form-control" placeholder="(XXX) XXX-XXXX" required></div>
                            </div>
                            <div class="form-group"><label class="form-label" for="email">Email Address *</label><input type="email" id="email" name="email" class="form-control" required></div>
                            <div class="form-group">
                                <label class="form-label" for="leadSource">How did you hear about us? *</label>
                                <select id="leadSource" name="leadSource" class="form-control" required><option value="">Select source</option><option value="Nextdoor">Nextdoor</option><option value="Facebook">Facebook</option><option value="Referral">Referral</option><option value="Direct">Direct</option><option value="Other">Other</option></select>
                            </div>
                            <div class="form-row">
                                <div class="form-group"><label class="form-label" for="vehicleYear">Vehicle Year *</label><select id="vehicleYear" name="vehicleYear" class="form-control" required><option value="">Select Year</option></select></div>
                                <div class="form-group"><label class="form-label" for="vehicleMake">Vehicle Make *</label><select id="vehicleMake" name="vehicleMake" class="form-control" required><option value="">Select Make</option></select></div>
                            </div>
                            <div class="form-group"><label class="form-label" for="vehicleModel">Vehicle Model *</label><select id="vehicleModel" name="vehicleModel" class="form-control" required disabled><option value="">Select Make First</option></select></div>
                            <div class="form-group"><label class="form-label" for="issueDescription">Describe the Issue (Optional)</label><textarea id="issueDescription" name="issueDescription" class="form-control" rows="4" placeholder="e.g., Engine light is on, rough idle, need regular maintenance..."></textarea></div>
                            <div class="form-group">
                                <label class="form-label">Service Needed *</label>
                                <button type="button" id="getAiRecommendationBtn" class="btn btn--secondary" style="margin-bottom: 1rem; width: 100%;">✨ Help Me Choose a Service</button>
                                <div id="aiRecommendation"></div>
                                <div class="service-options">
                                    <div class="service-option"><input type="radio" id="basic" name="serviceType" value="Basic Tune-Up - $250" required><label for="basic" class="service-option-label"><div class="service-option-title">Basic Tune-Up - $250</div><div class="service-option-desc">Spark plugs, air filter, basic inspection</div></label></div>
                                    <div class="service-option"><input type="radio" id="comprehensive" name="serviceType" value="Comprehensive Tune-Up - $350" required><label for="comprehensive" class="service-option-label"><div class="service-option-title">Comprehensive Tune-Up - $350</div><div class="service-option-desc">Full service including filters, fluids, diagnostics</div></label></div>
                                    <div class="service-option"><input type="radio" id="premium" name="serviceType" value="Premium Tune-Up - $450" required><label for="premium" class="service-option-label"><div class="service-option-title">Premium Tune-Up - $450</div><div class="service-option-desc">Complete service with additional maintenance items</div></label></div>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group"><label class="form-label" for="appointmentDate">Preferred Appointment Date *</label><input type="date" id="appointmentDate" name="appointmentDate" class="form-control" required></div>
                                <div class="form-group"><label class="form-label" for="appointmentTime">Preferred Time *</label><input type="time" id="appointmentTime" name="appointmentTime" class="form-control" required></div>
                            </div>
                            <div class="form-group"><label class="form-label" for="serviceAddress">Service Address *</label><textarea id="serviceAddress" name="serviceAddress" class="form-control" rows="3" placeholder="Full address where service will be performed..." required></textarea></div>
                            <div class="form-actions"><button type="submit" class="btn btn--primary btn--full">Submit Request</button><a href="https://calendly.com/autotech7/30min" target="_blank" class="calendly-link">📅 Book via Calendly</a></div>
                        </form>
                    </div>
                </div>
            </section>
        </div> <!-- End Booking Pane -->

    </main> <!-- End Tab Content Area -->


    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-links">
                    <!-- Updated Phone -->
                    <a href="tel:+17739999783">(773) 999-9783</a>
                    <a href="mailto:admin@at7.it.com">admin@at7.it.com</a>
                </div>
                <p class="footer-text">Serving South Fulton, Union City, Fairburn, Palmetto</p>
            </div>
            <p class="footer-copyright">&copy; <span id="currentYear">2025</span> AUTOTECH7. All rights reserved.</p>
        </div>
    </footer>

    <script>
         // --- Vehicle Make/Model Data ---
         const vehicleData = {
            "Toyota": ["Camry", "Corolla", "RAV4", "Highlander", "Tacoma", "Sienna", "4Runner", "Prius", "Other"],
            "Honda": ["Civic", "Accord", "CR-V", "Pilot", "Odyssey", "HR-V", "Ridgeline", "Other"],
            "Ford": ["F-150", "Explorer", "Escape", "Mustang", "Edge", "Bronco", "Ranger", "Expedition", "Other"],
            "Chevrolet": ["Silverado", "Equinox", "Tahoe", "Malibu", "Traverse", "Blazer", "Suburban", "Camaro", "Other"],
            "Nissan": ["Altima", "Rogue", "Sentra", "Maxima", "Pathfinder", "Murano", "Titan", "Frontier", "Other"],
            "Jeep": ["Grand Cherokee", "Wrangler", "Cherokee", "Compass", "Renegade", "Other"],
            "Hyundai": ["Elantra", "Sonata", "Tucson", "Santa Fe", "Palisade", "Kona", "Other"],
            "Kia": ["Optima/K5", "Sorento", "Sportage", "Telluride", "Forte", "Soul", "Other"],
            "BMW": ["3 Series", "5 Series", "X3", "X5", "X1", "7 Series", "Other"],
            "Mercedes-Benz": ["C-Class", "E-Class", "GLC", "GLE", "S-Class", "Other"],
            "Lexus": ["RX", "ES", "NX", "IS", "GX", "Other"],
            "Subaru": ["Outback", "Forester", "Crosstrek", "Ascent", "Impreza", "Other"],
            "GMC": ["Sierra", "Yukon", "Acadia", "Terrain", "Other"],
            "Ram": ["1500", "2500", "3500", "Other"],
            "Volkswagen": ["Jetta", "Tiguan", "Atlas", "Passat", "Golf", "Other"],
            "Mazda": ["CX-5", "Mazda3", "CX-9", "Mazda6", "Other"],
            "Dodge": ["Charger", "Challenger", "Durango", "Other"],
            "Chrysler": ["Pacifica", "300", "Other"],
            "Acura": ["MDX", "RDX", "TLX", "Integra", "Other"],
            "Audi": ["Q5", "Q7", "A4", "A6", "Other"],
            "Cadillac": ["Escalade", "XT5", "XT4", "CT5", "Other"],
            "Infiniti": ["QX60", "QX80", "Q50", "Other"],
            "Volvo": ["XC90", "XC60", "S60", "Other"],
            "Other": ["Other"] // Fallback
         };


        // --- Gemini API Call Function ---
        async function callGeminiApi(prompt, useSearch = false) {
            const apiKey = "AIzaSyCnhz2MmM_zTFgKzLw7xWYDRWHhKufXce4"; // <<< HARDCODED KEY (Security Risk!)
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
            const payload = { contents: [{ parts: [{ text: prompt }] }], };
            if (useSearch) { payload.tools = [{ "google_search": {} }]; console.log("Using Google Search grounding..."); }
             else { console.log("Not using Google Search grounding..."); }
            console.log("Sending prompt:", prompt);
            let attempts = 0; const maxAttempts = 5; let delay = 1000;
            while (attempts < maxAttempts) {
                try {
                    const response = await fetch(apiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
                    if (!response.ok) {
                        if (response.status === 429 || response.status >= 500) { await new Promise(resolve => setTimeout(resolve, delay)); delay *= 2; attempts++; continue; }
                        else { const errorBody = await response.text(); throw new Error(`API error: ${response.status} - ${errorBody}`); }
                    }
                    const result = await response.json(); console.log("Received response:", result);
                    const candidate = result.candidates?.[0];
                    let sources = [];
                    if (useSearch && candidate?.groundingMetadata?.groundingAttributions) { sources = candidate.groundingMetadata.groundingAttributions.map(attr => ({ uri: attr.web?.uri, title: attr.web?.title })).filter(s => s.uri && s.title); console.log("Sources:", sources); }
                    if (candidate?.content?.parts?.[0]?.text) { return { text: candidate.content.parts[0].text.trim(), sources: sources }; }
                    else { const fr = candidate?.finishReason; if (fr && fr !== "STOP") { throw new Error(`API stopped: ${fr}.`); } throw new Error("No text in response."); }
                } catch (error) { console.error("API call attempt error:", error); if (attempts >= maxAttempts - 1) { throw error; } await new Promise(resolve => setTimeout(resolve, delay)); delay *= 2; attempts++; }
            }
            throw new Error(`API call failed after ${maxAttempts} attempts.`);
        }

        // --- Mobile Menu Toggle ---
        function initializeMobileMenu() {
             const toggleButton = document.querySelector('.mobile-menu-toggle');
             const mobileMenu = document.querySelector('.mobile-menu'); // Target mobile menu specifically
             const header = document.querySelector('.header');
             if (toggleButton && mobileMenu && header) {
                 toggleButton.addEventListener('click', () => {
                      const isOpen = header.classList.toggle('mobile-menu-active');
                      toggleButton.classList.toggle('open', isOpen);
                      toggleButton.setAttribute('aria-expanded', isOpen);
                 });
             }
        }
         function closeMobileMenu() {
             const toggleButton = document.querySelector('.mobile-menu-toggle');
             const header = document.querySelector('.header');
             if (header && header.classList.contains('mobile-menu-active')) {
                  header.classList.remove('mobile-menu-active');
                  if(toggleButton) { toggleButton.classList.remove('open'); toggleButton.setAttribute('aria-expanded', 'false'); }
             }
         }

        // --- Tab Switching Logic ---
        function switchTab(targetId) {
            document.querySelectorAll('.tab-pane').forEach(pane => pane.classList.remove('active'));
            document.querySelectorAll('.tab-button').forEach(button => button.classList.remove('active'));
            const targetPane = document.getElementById(targetId);
            const targetButtons = document.querySelectorAll(`.tab-button[data-target="${targetId}"]`);
            if (targetPane) targetPane.classList.add('active');
            targetButtons.forEach(button => button.classList.add('active'));
            window.scrollTo({ top: 0, behavior: 'smooth' });
            closeMobileMenu();
        }

        // --- Initialize the application ---
        document.addEventListener('DOMContentLoaded', () => initializeApp());
        function initializeApp() {
            const currentYearEl = document.getElementById('currentYear');
            if (currentYearEl && currentYearEl.textContent === '2025') { currentYearEl.textContent = new Date().getFullYear(); }
            populateVehicleYears(); populateVehicleMakes();
            initializeMakeModelDropdowns('#vehicleMake', '#vehicleModel');
            initializeMakeModelDropdowns('#partsVehicleMake', '#partsVehicleModel');
            populatePartsFinderDropdowns(); setMinimumDate(); initializeForm(); initializePhoneFormatting();
            initializeSmoothScrolling(); initializeAIRecommendation(); initializeHeaderLogoLink();
            initializeAIAssistant(); initializeAIDiagnoser(); initializePartsFinder();
            initializeMobileMenu(); initializeTabNavigation();
        }

        // --- Populate Dropdowns ---
         function populatePartsFinderDropdowns() {
             const yearSelect = document.getElementById('partsVehicleYear');
             const makeSelect = document.getElementById('partsVehicleMake');
             if (yearSelect) { const cy = new Date().getFullYear(); for (let y = cy; y >= 1990; y--) { const o = document.createElement('option'); o.value = y; o.textContent = y; yearSelect.appendChild(o); } }
             if (makeSelect) { const makes = Object.keys(vehicleData).sort(); makes.forEach(m => { const o = document.createElement('option'); o.value = m; o.textContent = m; makeSelect.appendChild(o); }); }
         }
        function populateVehicleMakes() {
             const makeSelectBooking = document.getElementById('vehicleMake');
             if (makeSelectBooking) { const makes = Object.keys(vehicleData).sort(); makes.forEach(m => { const o = document.createElement('option'); o.value = m; o.textContent = m; makeSelectBooking.appendChild(o); }); }
        }
        function initializeMakeModelDropdowns(makeSelector, modelSelector) {
            const makeSelect = document.querySelector(makeSelector); const modelSelect = document.querySelector(modelSelector);
            if (!makeSelect || !modelSelect) { console.warn(`Dropdowns not found: ${makeSelector}, ${modelSelector}`); return; }
            makeSelect.addEventListener('change', () => {
                const selectedMake = makeSelect.value; modelSelect.innerHTML = ''; modelSelect.disabled = true;
                const defOpt = document.createElement('option'); defOpt.value = "";
                if (selectedMake && vehicleData[selectedMake]) {
                    defOpt.textContent = "Select Model"; modelSelect.appendChild(defOpt);
                    vehicleData[selectedMake].forEach(m => { const o = document.createElement('option'); o.value = m; o.textContent = m; modelSelect.appendChild(o); });
                    modelSelect.disabled = false;
                } else { defOpt.textContent = selectedMake ? "Models not listed" : "Select Make First"; modelSelect.appendChild(defOpt); }
            });
        }

        // --- Tab Navigation Initialization ---
        function initializeTabNavigation() {
            const allTabButtons = document.querySelectorAll('.tab-button');
            const tabSwitchers = document.querySelectorAll('.tab-switcher');
            allTabButtons.forEach(button => button.addEventListener('click', () => switchTab(button.dataset.target)));
            tabSwitchers.forEach(switcher => {
                switcher.addEventListener('click', (e) => {
                    e.preventDefault(); const ttsn = switcher.dataset.targetTab; const ttid = ttsn ? ttsn + '-pane' : null; if (!ttid) return; switchTab(ttid);
                    const service = switcher.dataset.service; const area = switcher.dataset.area;
                    setTimeout(() => {
                        if (service) { const r = document.getElementById(service); if (r) r.checked = true; const so = document.querySelector('#book-pane .service-options'); if (so) so.scrollIntoView({ behavior: 'smooth', block: 'center' }); }
                        else if (area) { const af = document.getElementById('serviceAddress'); if (af) { af.value = area + ", GA"; af.focus(); af.scrollIntoView({ behavior: 'smooth', block: 'center' }); } }
                        else if (switcher.id === 'bookDiagnosisBtn') { const r = document.getElementById('comprehensive'); const idf = document.getElementById('issueDescription'); const si = document.getElementById('symptomsInput'); const vii = document.getElementById('vehicleInfoInput'); if (r) r.checked = true; if (idf && si?.value) { const dp = "From AI Diagnoser:"; if (!idf.value || idf.value.startsWith(dp)) { idf.value = `${dp}\nVehicle: ${vii?.value || 'N/A'}\nSymptoms: ${si.value}`; } idf.focus(); idf.scrollIntoView({ behavior: 'smooth', block: 'center' }); } else if (idf) { idf.scrollIntoView({ behavior: 'smooth', block: 'center' }); } }
                        else if (ttid === 'book-pane') { const fc = document.querySelector('#book-pane .form-container'); if (fc) fc.scrollIntoView({ behavior: 'smooth', block: 'start' }); }
                    }, 50);
                });
            });
            const logoLink = document.getElementById('logoLink'); if (logoLink) logoLink.addEventListener('click', (e) => { e.preventDefault(); const hb = document.querySelector('.tab-button[data-target="home-pane"]'); if (hb) hb.click(); });
        }

        // --- AI Tool Logic (Diagnoser, FAQ, Parts) ---
        function initializeAIDiagnoser() {
             const btn = document.getElementById('getAiDiagnosisBtn'); const vi = document.getElementById('vehicleInfoInput'); const si = document.getElementById('symptomsInput'); const ad = document.getElementById('aiDiagnosisAnswer'); const bb = document.getElementById('bookDiagnosisBtn'); const sbs = document.querySelectorAll('.symptom-button');
             if (!btn || !si || !ad || !bb) { console.warn("AI Diagnoser elements missing."); return; }
             btn.addEventListener('click', handleGetDiagnosis);
             sbs.forEach(b => b.addEventListener('click', () => { const ct = si.value.trim(); const s = b.textContent.trim(); si.value = ct ? `${ct}, ${s}` : s; si.focus(); si.style.borderColor='var(--primary-color)'; setTimeout(()=>si.style.borderColor='',500); }));
             async function handleGetDiagnosis() {
                 const s = si.value.trim(); const v = vi.value.trim() || 'N/A'; if (!s) { ad.textContent = 'Please describe symptoms or select issues.'; ad.className = 'error'; ad.style.display = 'block'; bb.style.display = 'none'; return; }
                 const p = `Expert mechanic AI for AUTOTECH7.\nVehicle: ${v}\nSymptoms: "${s}"\n\nGive 2-3 likely problems (1 sentence each). No repair advice. Start with "Based on your description, here are a few possibilities (preliminary diagnosis, inspection needed):" Format as an unordered list (* bullets).`;
                 btn.disabled = true; btn.innerHTML = '✨ Diagnosing... <span class="spinner"></span>'; ad.innerHTML = '<span class="spinner"></span> Analyzing...'; ad.className = 'loading'; ad.style.display = 'block'; bb.style.display = 'none';
                 try { const { text: a } = await callGeminiApi(p, false); let ha = a.replace(/^\* (.*)$/gm, '<li>$1</li>'); if (ha.includes('<li>')) { const fi = ha.indexOf('<li>'); const li = ha.lastIndexOf('</li>'); if (fi !== -1 && li !== -1) { ha = ha.substring(0, fi) + '<ul>' + ha.substring(fi, li + 5) + '</ul>' + ha.substring(li + 5); } } ad.innerHTML = ha; ad.className = ''; bb.style.display = 'block'; }
                 catch (e) { console.error("Diag error:", e); ad.textContent = `Sorry, couldn't diagnose. Try again or use the form. Error: ${e.message}`; ad.className = 'error'; bb.style.display = 'none'; }
                 finally { btn.disabled = false; btn.innerHTML = '✨ Get AI Diagnosis'; }
             }
        }
        function initializeAIAssistant() {
             const btn = document.getElementById('askAiBtn'); const qi = document.getElementById('aiQuestionInput'); const ad = document.getElementById('aiAnswer'); const fbs = document.querySelectorAll('.faq-button');
             if (!btn || !qi || !ad) { console.warn("AI Assistant elements missing."); return; }
             btn.addEventListener('click', handleAskAI); qi.addEventListener('keypress', (e) => { if (e.key === 'Enter') handleAskAI(); });
             fbs.forEach(b => b.addEventListener('click', () => { qi.value = b.textContent.trim(); setTimeout(handleAskAI, 100); }));
             async function handleAskAI() {
                 const q = qi.value.trim(); if (!q) { ad.textContent = 'Enter a question or select one.'; ad.className = 'error'; return; }
                 const svc = `- Basic ($250): Plugs, air filter, inspection.\n- Comp ($350): Full svc (filters, fluids, diag, plugs).\n- Prem ($450): Comp + fuel/throttle clean.`; const area = "S Fulton, Union City, Fairburn, Palmetto."; const kf = "Mobile svc, transparent $, licensed/insured, same-week avail.";
                 const p = `Helpful AI for AUTOTECH7 (mobile tech in Fulton Co, GA). Answer concisely (1-3 sentences). If unrelated to cars/AUTOTECH7, politely decline.\nInfo:\n- Svcs: ${svc}\n- Area: ${area}\n- Feats: ${kf}\n- We come to you.\n- Book via form/Calendly.\n- 2hr response time.\nUser Q: "${q}"\nAnswer:`;
                 btn.disabled = true; btn.innerHTML = '✨ Asking... <span class="spinner"></span>'; ad.innerHTML = '<span class="spinner"></span> Getting answer...'; ad.className = 'loading';
                 try { const { text: a } = await callGeminiApi(p, false); ad.textContent = a; ad.className = ''; }
                 catch (e) { console.error("FAQ error:", e); ad.textContent = `Sorry, couldn't answer. Try again or contact us. Error: ${e.message}`; ad.className = 'error'; }
                 finally { btn.disabled = false; btn.innerHTML = '✨ Ask'; }
             }
        }
        function initializePartsFinder() {
            const btn=d.getElementById('findPartsBtn'), y=d.getElementById('partsVehicleYear'), ma=d.getElementById('partsVehicleMake'), mo=d.getElementById('partsVehicleModel'), t=d.getElementById('partsType'), ad=d.getElementById('aiPartsAnswer');
            if(!btn||!y||!ma||!mo||!t||!ad) {console.warn("Parts Finder elements missing."); return;} btn.addEventListener('click', handleFindParts);
            async function handleFindParts() {
                const yr=y.value, mk=ma.value, md=mo.value, pt=t.value; if(!yr||!mk||!md||!pt){ad.textContent='Select Year, Make, Model, and Part/Fluid Type.';ad.className='error';return;}
                // Updated Prompt for Parts Finder
                const p=`Act as an auto parts specialist assistant. For a ${yr} ${mk} ${md}, provide guidance on finding the correct ${pt}. Include:\n1. Common specifications (like oil viscosity/type 5W-30 Synthetic, filter size/type, spark plug gap like 0.044 inches, battery group size like Group 24F, etc.).\n2. Use search grounding to find and include 1-2 example product links (e.g., from AutoZone.com, OReillyAuto.com, RockAuto.com) that *match the specifications* for this vehicle and part type.\n3. Mention common places to purchase (local auto parts stores like AutoZone, O'Reilly, Advance Auto Parts; online retailers).\nStart the response with "For a ${yr} ${mk} ${md}, here's some general guidance on ${pt}:". Mention that provided links are *online examples* and don't reflect local stock.\nCrucially, end the response *exactly* with the following disclaimer on a new line:\n"**Disclaimer:** This is general information. Always verify compatibility with your owner's manual or a professional like AUTOTECH7 before purchasing parts. AUTOTECH7 can also supply the correct parts during your service."`;

                btn.disabled=true; btn.innerHTML='✨ Finding... <span class="spinner"></span>'; ad.innerHTML='<span class="spinner"></span> Searching...'; ad.className='loading';
                try {
                     // Use search grounding (true)
                     const {text: a}=await callGeminiApi(p, true);
                     // Make links clickable in HTML
                     const linkifiedAnswer = a.replace(/(https?:\/\/[^\s]+)/g, '<a href="$1" target="_blank" rel="noopener noreferrer">$1</a>');
                     ad.innerHTML=linkifiedAnswer.replace(/\n/g, '<br>'); // Preserve line breaks and render links
                     ad.className='';
                }
                catch(e){ console.error("Parts error:",e); ad.textContent=`Sorry, couldn't find info. Try again or check manual. Error: ${e.message}`; ad.className='error';}
                finally { btn.disabled=false; btn.innerHTML='✨ Find Info';}
            }
         } const d=document; // Alias for document


        // --- Other Initialization Functions ---
        function initializeHeaderLogoLink() { 
            const logoLink = document.getElementById('logoLink');
            if (logoLink) {
                logoLink.addEventListener('click', () => switchTab('home-pane'));
                logoLink.style.cursor = 'pointer';
            }
        } 
        function initializeServiceCardClicks() { /* Moved */ } 
        function initializeAreaBadgeClicks() { /* Moved */ }
        function populateVehicleYears() {
             const ysb = d.getElementById('vehicleYear'); if (ysb) { const cy = new Date().getFullYear(); for (let y = cy; y >= 2010; y--) { const o = d.createElement('option'); o.value = y; o.textContent = y; ysb.appendChild(o); } }
        }
        function setMinimumDate() { const di = d.getElementById('appointmentDate'); if (!di) return; const t = new Date(); t.setDate(t.getDate() + 1); di.min = t.toISOString().split('T')[0]; }
        function initializePhoneFormatting() { const bp = d.getElementById('book-pane'); const pi = bp ? bp.querySelector('#phone') : null; if (!pi) return; pi.addEventListener('input', (e) => { let v = e.target.value.replace(/\D/g, '').slice(0, 10); if (v.length >= 7) v = `(${v.slice(0, 3)}) ${v.slice(3, 6)}-${v.slice(6)}`; else if (v.length >= 4) v = `(${v.slice(0, 3)}) ${v.slice(3)}`; else if (v.length >= 1) v = `(${v.slice(0, 3)}`; e.target.value = v; }); }
        function initializeForm() { const f = d.getElementById('appointmentForm'); if (!f) return; f.addEventListener('submit', (e) => { if (!validateForm()) { e.preventDefault(); return; } const sb = f.querySelector('button[type="submit"]'); if (sb) { sb.disabled = true; sb.textContent = 'Submitting...'; } }); }
        function validateForm() {
            const abp=d.getElementById('book-pane'); const f=abp?abp.querySelector('#appointmentForm'):null; if(!f)return false; let iv=true, fef=null; f.querySelectorAll('.service-option-label').forEach(l=>l.style.borderColor=''); const soc=f.querySelector('.service-options'); if(soc)soc.style.border='';
            f.querySelectorAll('[required]').forEach(fi => { if(!fi.closest('#appointmentForm'))return; let fiInv=false; if(fi.type==='radio'&&fi.name==='serviceType'){if(!f.querySelector('input[name="serviceType"]:checked')){fiInv=true;if(soc){soc.style.border='2px solid #FF5459';soc.style.borderRadius='var(--radius)';soc.style.padding='5px';}}} else if(fi.tagName==='SELECT'&&fi.value===''){fiInv=true;fi.style.borderColor='#FF5459';} else if(fi.tagName!=='SELECT'&&(!fi.value||fi.value.trim()==='')){fiInv=true;fi.style.borderColor='#FF5459';} else {fi.style.borderColor='';} if(fiInv){iv=false;if(!fef)fef=fi;} });
            const pi=f.querySelector('#phone'); if(pi&&pi.value.trim()&&pi.style.borderColor!=='rgb(255, 84, 89)'){if(!/^\(\d{3}\) \d{3}-\d{4}$/.test(pi.value)){pi.style.borderColor='#FF5459';iv=false;if(!fef)fef=pi;}}
            const ei=f.querySelector('#email'); if(ei&&ei.value.trim()&&ei.style.borderColor!=='rgb(255, 84, 89)'){if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(ei.value)){ei.style.borderColor='#FF5459';iv=false;if(!fef)fef=ei;}}
            if(!iv){alert('Please fill all required fields correctly.'); if(fef){const btb=d.querySelector('.tab-button[data-target="book-pane"]'); if(btb&&!btb.classList.contains('active')){btb.click();setTimeout(()=>{fef.focus();fef.scrollIntoView({behavior:'smooth',block:'center'});},100);}else{fef.focus();fef.scrollIntoView({behavior:'smooth',block:'center'});}}} return iv;
        }
        function initializeSmoothScrolling() { console.log("Smooth scrolling simplified."); }
        function initializeAIRecommendation() {
            const btn=d.getElementById('getAiRecommendationBtn'), rd=d.getElementById('aiRecommendation'), bp=d.getElementById('book-pane'); if(!bp)return;
            const yi=bp.querySelector('#vehicleYear'), mai=bp.querySelector('#vehicleMake'), moi=bp.querySelector('#vehicleModel'), ii=bp.querySelector('#issueDescription'), rls=bp.querySelectorAll('.service-option-label');
            if(!btn||!rd||!yi||!mai||!moi||!ii){console.warn("AI Rec elements missing."); return;} btn.addEventListener('click', async()=>{
                const y=yi.value, ma=mai.value, mo=moi.value, i=ii.value.trim(); if(!y||!ma||!mo){rd.textContent='Select Year, Make, & Model.';rd.className='error';rd.style.display='block';return;}
                const p=`Assist AUTOTECH7 tech.\nVehicle: ${y} ${ma} ${mo}\nIssue: ${i||'Routine maint.'}\nSvcs:\n1. Basic ($250): Plugs, air filter, inspect.\n2. Comp ($350): Full svc (filters, fluids, diag, plugs).\n3. Prem ($450): Comp + fuel/throttle clean.\nRecommend best svc (Basic, Comp, or Prem Tune-Up) + 1 sentence reason. Ex: Comprehensive Tune-Up: Covers routine maint & diagnostics.`;
                btn.disabled=true; btn.innerHTML='✨ Thinking...<span class="spinner"></span>'; rd.textContent='';rd.className='';rd.style.display='none'; rls.forEach(l=>l.classList.remove('recommended'));
                try{const{text: rt}=await callGeminiApi(p,false); rd.textContent=`AI Suggestion: ${rt}`; rd.style.display='block'; let rri=null; const lt=rt.toLowerCase(); if(lt.includes('basic'))rri='basic'; else if(lt.includes('comp'))rri='comprehensive'; else if(lt.includes('prem'))rri='premium'; if(rri){const r=bp.querySelector(`#${rri}`); const l=r?.nextElementSibling; if(l){l.classList.add('recommended');l.scrollIntoView({behavior:'smooth',block:'nearest'});}}}
                catch(e){console.error("AI Rec error:",e); rd.textContent=`Rec failed: ${e.message}`;rd.className='error';rd.style.display='block';}
                finally{btn.disabled=false; btn.innerHTML='✨ Help Me Choose';} });
        }
        d.addEventListener('DOMContentLoaded', ()=>{ d.querySelectorAll('.service-card').forEach(c=>{c.addEventListener('mouseenter',()=>c.classList.add('service-card--hover'));c.addEventListener('mouseleave',()=>c.classList.remove('service-card--hover'));}); const bp=d.getElementById('book-pane'); if(bp){ bp.querySelectorAll('input[name="serviceType"]').forEach(r=>{const l=r.nextElementSibling; if(!l)return; r.addEventListener('focus',()=>l.style.boxShadow='0 0 0 3px rgba(var(--primary-color-rgb), 0.3)'); r.addEventListener('blur',()=>l.style.boxShadow='');}); } });
    </script>
</body>
</html>

